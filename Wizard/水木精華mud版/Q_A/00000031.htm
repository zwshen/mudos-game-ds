<HTML>
<HEAD>
<TITLE>BBS水木清華站︰精華區</TITLE>
</HEAD>
<BODY>
<CENTER><H1>BBS水木清華站︰精華區</H1></CENTER>
<A Name="top"></a>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Wed&nbsp;Jan&nbsp;&nbsp;3&nbsp;16:07:47&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
我們架設著一個自己的fy改動版本&nbsp;<BR>
遇到了以下的情況希望能夠有人幫忙&nbsp;<BR>
（不知道是不是老問題）&nbsp;<BR>
就是更新問題&nbsp;<BR>
1。房間更新的時候如果npc不在（該npc在別的房間裡，比如random&nbsp;move的）&nbsp;<BR>
&nbsp;&nbsp;&nbsp;並不是呼喚回來而是從新生成（檢查過room.c的reset()函數似乎沒有問題）&nbsp;<BR>
2。玩家的年齡總也不長，（希望知道這個使那裡控制長歲數的，難道是2000年bug）&nbsp;<BR>
&nbsp;&nbsp;&nbsp;我們已經開設了1年多。好像2000年以前沒有這個問題&nbsp;<BR>
&nbsp;<BR>
不知道那位大蝦能幫忙的說&nbsp;<BR>
順便點撥我更新的機理是什麼？就是那裡設定著15分鐘一次的全部更新&nbsp;<BR>
另外這裡付上我們的room.c中的reset()函數&nbsp;<BR>
&nbsp;<BR>
void&nbsp;reset()&nbsp;<BR>
{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mapping&nbsp;ob_list,&nbsp;ob;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;*list;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i,j;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;*inv;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;I&nbsp;put&nbsp;this&nbsp;one&nbsp;here&nbsp;to&nbsp;get&nbsp;rid&nbsp;the&nbsp;function&nbsp;of&nbsp;trash&nbsp;collecting...&nbsp;<BR>
Tie&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;since&nbsp;the&nbsp;quest&nbsp;feature,&nbsp;rooms&nbsp;hardly&nbsp;get&nbsp;swarpped&nbsp;out.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv&nbsp;=&nbsp;all_inventory();&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i=sizeof(inv)-1;&nbsp;i&gt;=0;&nbsp;i--)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(inv[i]-&gt;is_character())&nbsp;continue;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(inv[i]-&gt;query(&quot;no_get&quot;))&nbsp;continue;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(inv[i]-&gt;is_corpse())&nbsp;continue;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct(inv[i]);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Check&nbsp;loaded&nbsp;objects&nbsp;to&nbsp;match&nbsp;the&nbsp;objects&nbsp;specified&nbsp;in&nbsp;&quot;objects&quot;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;while&nbsp;query(&quot;objects&quot;)&nbsp;is&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;([&nbsp;&lt;object&nbsp;filename&gt;:&nbsp;&lt;amount&gt;,&nbsp;.....&nbsp;])&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;and&nbsp;query_temp(&quot;objects&quot;)&nbsp;is&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;([&nbsp;&lt;object&nbsp;filename&gt;:&nbsp;({ob1,&nbsp;ob2,&nbsp;...}),&nbsp;....&nbsp;])&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set(&quot;no_clean_up&quot;,&nbsp;0);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob_list&nbsp;=&nbsp;query(&quot;objects&quot;);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!mapp(ob_list)&nbsp;)&nbsp;return;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!mapp(ob&nbsp;=&nbsp;query_temp(&quot;objects&quot;))&nbsp;)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob&nbsp;=&nbsp;allocate_mapping(sizeof(ob_list));&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;=&nbsp;keys(ob_list);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i=0;&nbsp;i&lt;sizeof(list);&nbsp;i++)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Allocate&nbsp;an&nbsp;array&nbsp;if&nbsp;we&nbsp;have&nbsp;multiple&nbsp;same&nbsp;object&nbsp;specified.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;undefinedp(ob[list[i]])&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intp(ob_list[list[i]])&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob_list[list[i]]&nbsp;&gt;&nbsp;1&nbsp;)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob[list[i]]&nbsp;=&nbsp;allocate(ob_list[list[i]]);&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch(ob_list[list[i]])&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;1:&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!ob[list[i]]&nbsp;)&nbsp;ob[list[i]]&nbsp;=&nbsp;make_inventory(list[i]);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;environment(ob[list[i]])&nbsp;!=&nbsp;this_object()&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob[list[i]]-&gt;is_character()&nbsp;)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!ob[list[i]]-&gt;return_home(this_object())&nbsp;)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add(&quot;no_clean_up&quot;,&nbsp;1);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(j=0;&nbsp;j&lt;ob_list[list[i]];&nbsp;j++)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;If&nbsp;the&nbsp;object&nbsp;is&nbsp;gone,&nbsp;make&nbsp;another&nbsp;one.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!objectp(ob[list[i]][j])&nbsp;)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob[list[i]][j]&nbsp;=&nbsp;make_inventory(list[i]);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Try&nbsp;to&nbsp;call&nbsp;the&nbsp;wandering&nbsp;npc&nbsp;come&nbsp;back&nbsp;here.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;environment(ob[list[i]][j])&nbsp;!=&nbsp;this_object()&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob[list[i]][j]-&gt;is_character()&nbsp;)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!ob[list[i]][j]-&gt;return_home(this_object())&nbsp;)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add(&quot;no_clean_up&quot;,&nbsp;1);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_temp(&quot;objects&quot;,&nbsp;ob);&nbsp;<BR>
}&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Wed&nbsp;Jan&nbsp;&nbsp;3&nbsp;18:47:02&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
關於更新看看2471吧&nbsp;<BR>
至於age,由heart_beat()調用update_age()&nbsp;&nbsp;前者在char.c&nbsp;&nbsp;後者在user.c裡&nbsp;<BR>
&nbsp;&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;我們架設著一個自己的fy改動版本&nbsp;</I><BR>
︰<I>&nbsp;遇到了以下的情況希望能夠有人幫忙&nbsp;</I><BR>
︰<I>&nbsp;（不知道是不是老問題）&nbsp;</I><BR>
︰<I>&nbsp;就是更新問題&nbsp;</I><BR>
︰<I>&nbsp;1。房間更新的時候如果npc不在（該npc在別的房間裡，比如random&nbsp;move的）&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;並不是呼喚回來而是從新生成（檢查過room.c的reset()函數似乎沒有問題）&nbsp;</I><BR>
︰<I>&nbsp;2。玩家的年齡總也不長，（希望知道這個使那裡控制長歲數的，難道是2000年bug）&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;我們已經開設了1年多。好像2000年以前沒有這個問題&nbsp;</I><BR>
︰<I>&nbsp;不知道那位大蝦能幫忙的說&nbsp;</I><BR>
︰<I>&nbsp;順便點撥我更新的機理是什麼？就是那裡設定著15分鐘一次的全部更新&nbsp;</I><BR>
︰<I>&nbsp;另外這裡付上我們的room.c中的reset()函數&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Wed&nbsp;Jan&nbsp;&nbsp;3&nbsp;18:59:15&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
可是在xyj2000的裡面房間更新等等卻做得很好&nbsp;<BR>
房間自動更新的時候相關的npc全部被呼喚回來&nbsp;<BR>
而且絕對沒有重複的，即便是克隆都會發現原來的那個貝克隆過來而不是從新生成的&nbsp;<BR>
這是為什麼？？&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;關於更新看看2471吧&nbsp;</I><BR>
︰<I>&nbsp;至於age,由heart_beat()調用update_age()&nbsp;&nbsp;前者在char.c&nbsp;&nbsp;後者在user.c裡&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Wed&nbsp;Jan&nbsp;&nbsp;3&nbsp;23:29:46&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
你隨便找個有npc的房間&nbsp;<BR>
call&nbsp;npc-&gt;command_function(&quot;e&quot;)&nbsp;<BR>
然後再&nbsp;call&nbsp;here-&gt;reset()&nbsp;<BR>
看他是回來了還是重新new了一個&nbsp;<BR>
&nbsp;<BR>
如果回來了,問題就不在reset裡(看那個reset()沒啥問題呀)&nbsp;<BR>
&nbsp;你說的情況有可能是該room被clean_up了&nbsp;<BR>
&nbsp;看看你的config是不是把time&nbsp;to&nbsp;clean&nbsp;up設得過低&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;可是在xyj2000的裡面房間更新等等卻做得很好&nbsp;</I><BR>
︰<I>&nbsp;房間自動更新的時候相關的npc全部被呼喚回來&nbsp;</I><BR>
︰<I>&nbsp;而且絕對沒有重複的，即便是克隆都會發現原來的那個貝克隆過來而不是從新生成的&nbsp;</I><BR>
︰<I>&nbsp;這是為什麼？？&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;09:42:56&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
現在設定的是&nbsp;<BR>
time&nbsp;to&nbsp;clean&nbsp;up&nbsp;:&nbsp;180&nbsp;<BR>
我考慮似乎和這個關係不是很大&nbsp;<BR>
原因是我同時在一個計算機裡面開了2個mud&nbsp;<BR>
一個是xyj2000,一個是fy&nbsp;<BR>
用的相同的config.cfg(我的xyj2000的config是從fy那裡拷貝的）&nbsp;<BR>
唯一不同是設定的服務器端口號碼和對外端口號碼不同&nbsp;<BR>
但是我在xyj2000裡面發現它的更新非常穩定&nbsp;<BR>
並且檢查到它的代碼裡面好像有一個“物品可存在個數”之類的參數&nbsp;<BR>
不過不知道到底怎麼起的作用但顯然的事實是&nbsp;<BR>
當我在xyj2000的十字街頭e一步clone&nbsp;/d/city/npc/libai.c的時候&nbsp;<BR>
發現十字街頭的李白消失了，也就是說李白在mud裡面指存在一個&nbsp;<BR>
而fy則不同我克隆東西的時候原來的東西是仍然存在的&nbsp;<BR>
至於房間reset()的代碼裡面阿鐵添加了一段代碼保證task體系的運行&nbsp;<BR>
這個是唯一和xyj2000不同的地方，是不是這個代碼導致了某些莫名其妙的問題？&nbsp;<BR>
&nbsp;<BR>
另外你所說的call&nbsp;npc-&gt;command_function(&quot;e&quot;)沒有作用的說&nbsp;<BR>
因為那個npc並沒有向東走，我試驗了&nbsp;<BR>
call&nbsp;npc-&gt;command(&quot;east&quot;)&nbsp;<BR>
call&nbsp;npc-&gt;command(&quot;go&nbsp;east&quot;)&nbsp;<BR>
之類的都不可以（當前房間有向東的出口）&nbsp;<BR>
老大再給點提示&nbsp;<BR>
我的先自行研究著先&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;你隨便找個有npc的房間&nbsp;</I><BR>
︰<I>&nbsp;call&nbsp;npc-&gt;command_function(&quot;e&quot;)&nbsp;</I><BR>
︰<I>&nbsp;然後再&nbsp;call&nbsp;here-&gt;reset()&nbsp;</I><BR>
︰<I>&nbsp;看他是回來了還是重新new了一個&nbsp;</I><BR>
︰<I>&nbsp;如果回來了,問題就不在reset裡(看那個reset()沒啥問題呀)&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;你說的情況有可能是該room被clean_up了&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;看看你的config是不是把time&nbsp;to&nbsp;clean&nbsp;up設得過低&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;修改:•mickangel&nbsp;於&nbsp;Jan&nbsp;&nbsp;4&nbsp;09:49:57&nbsp;修改本文•[FROM:&nbsp;&nbsp;&nbsp;&nbsp;202.206.1.31]&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:01:59&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
測試了&nbsp;<BR>
call&nbsp;here-&gt;reset()的時候npc是回來的&nbsp;<BR>
方法是&nbsp;<BR>
衙役跟隨官府的人行動我在衙門門口&nbsp;<BR>
call&nbsp;here-&gt;reset()&nbsp;<BR>
那些衙役回來了（監聽帶走衙役的player看到那些衙役都離開了）&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;現在設定的是&nbsp;</I><BR>
︰<I>&nbsp;time&nbsp;to&nbsp;clean&nbsp;up&nbsp;:&nbsp;180&nbsp;</I><BR>
︰<I>&nbsp;我考慮似乎和這個關係不是很大&nbsp;</I><BR>
︰<I>&nbsp;原因是我同時在一個計算機裡面開了2個mud&nbsp;</I><BR>
︰<I>&nbsp;一個是xyj2000,一個是fy&nbsp;</I><BR>
︰<I>&nbsp;用的相同的config.cfg(我的xyj2000的config是從fy那裡拷貝的）&nbsp;</I><BR>
︰<I>&nbsp;唯一不同是設定的服務器端口號碼和對外端口號碼不同&nbsp;</I><BR>
︰<I>&nbsp;但是我在xyj2000裡面發現它的更新非常穩定&nbsp;</I><BR>
︰<I>&nbsp;並且檢查到它的代碼裡面好像有一個“物品可存在個數”之類的參數&nbsp;</I><BR>
︰<I>&nbsp;不過不知道到底怎麼起的作用但顯然的事實是&nbsp;</I><BR>
︰<I>&nbsp;當我在xyj2000的十字街頭e一步clone&nbsp;/d/city/npc/libai.c的時候&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:14:11&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
clean&nbsp;up&nbsp;&nbsp;time確實低了點&nbsp;&nbsp;一個房間3min沒人去就destruct了&nbsp;<BR>
&nbsp;<BR>
e不行的&nbsp;<BR>
call&nbsp;xxx-&gt;command_function(&quot;east&quot;)試試吧&nbsp;<BR>
call&nbsp;command在有些mud裡是不行的&nbsp;<BR>
&nbsp;<BR>
反正就是把npc弄走,你把他smash了,在別的房間&nbsp;clone一個,再回來call&nbsp;reset()也行呀&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;現在設定的是&nbsp;</I><BR>
︰<I>&nbsp;time&nbsp;to&nbsp;clean&nbsp;up&nbsp;:&nbsp;180&nbsp;</I><BR>
︰<I>&nbsp;我考慮似乎和這個關係不是很大&nbsp;</I><BR>
︰<I>&nbsp;原因是我同時在一個計算機裡面開了2個mud&nbsp;</I><BR>
︰<I>&nbsp;一個是xyj2000,一個是fy&nbsp;</I><BR>
︰<I>&nbsp;用的相同的config.cfg(我的xyj2000的config是從fy那裡拷貝的）&nbsp;</I><BR>
︰<I>&nbsp;唯一不同是設定的服務器端口號碼和對外端口號碼不同&nbsp;</I><BR>
︰<I>&nbsp;但是我在xyj2000裡面發現它的更新非常穩定&nbsp;</I><BR>
︰<I>&nbsp;並且檢查到它的代碼裡面好像有一個“物品可存在個數”之類的參數&nbsp;</I><BR>
︰<I>&nbsp;不過不知道到底怎麼起的作用但顯然的事實是&nbsp;</I><BR>
︰<I>&nbsp;當我在xyj2000的十字街頭e一步clone&nbsp;/d/city/npc/libai.c的時候&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;BigY&nbsp;(懶蟲※馬不停蹄),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:20:14&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;clean&nbsp;up&nbsp;&nbsp;time確實低了點&nbsp;&nbsp;一個房間3min沒人去就destruct了&nbsp;</I><BR>
︰<I>&nbsp;e不行的&nbsp;</I><BR>
︰<I>&nbsp;call&nbsp;xxx-&gt;command_function(&quot;east&quot;)試試吧&nbsp;</I><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;要用go&nbsp;east吧。^^^^^^^^^^^^&nbsp;<BR>
︰<I>&nbsp;call&nbsp;command在有些mud裡是不行的&nbsp;</I><BR>
︰<I>&nbsp;反正就是把npc弄走,你把他smash了,在別的房間&nbsp;clone一個,再回來call&nbsp;reset()也行呀&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
--------------------------------------------------------------------------&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;情深不壽,強極則辱.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;謙謙君子,溫潤如玉.&nbsp;<BR>
--------------------------------------------------------------------------&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.53.170]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:29:51&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
那麼設定成多少合適？&nbsp;<BR>
我暫時改成900了。。可以麼？&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;clean&nbsp;up&nbsp;&nbsp;time確實低了點&nbsp;&nbsp;一個房間3min沒人去就destruct了&nbsp;</I><BR>
︰<I>&nbsp;e不行的&nbsp;</I><BR>
︰<I>&nbsp;call&nbsp;xxx-&gt;command_function(&quot;east&quot;)試試吧&nbsp;</I><BR>
︰<I>&nbsp;call&nbsp;command在有些mud裡是不行的&nbsp;</I><BR>
︰<I>&nbsp;反正就是把npc弄走,你把他smash了,在別的房間&nbsp;clone一個,再回來call&nbsp;reset()也行呀&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:58:08&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
e不行,因為npc的指令不調用aliasd.c&nbsp;<BR>
east應該是可以的,command裡發現&quot;exit&quot;裡的東東會自動加go的&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;BigY&nbsp;(懶蟲※馬不停蹄)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;要用go&nbsp;east吧。^^^^^^^^^^^^&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;11:36:22&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
room被clean_up了(destruct),裡面的npc也會被destruct&nbsp;<BR>
以後有人走來的時候會重新load_object,它set的&nbsp;objects也會重新載入&nbsp;<BR>
如果原來的npc被人打昏背走或是random&nbsp;move走了,就會出現兩個一樣的npc&nbsp;<BR>
這跟reset()裡,對npc使用return_home()是不一樣的&nbsp;<BR>
&nbsp;&nbsp;(一般reset()就幹一件事,npc在mud裡則return_home,不在則new一個,return_home.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;fy裡,reset還有個清理垃圾的小功能,不過你貼的那一段其實並不好,reset是房間&nbsp;<BR>
&nbsp;&nbsp;&nbsp;有人的話,會把他面前的物品弄的不翼而飛,這是不合理的,有人在的時候不應該清理&nbsp;<BR>
&nbsp;&nbsp;&nbsp;垃圾)&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
至於clean&nbsp;up&nbsp;&nbsp;time&nbsp;<BR>
hehe&nbsp;<BR>
這個主要是根據你mud裡人的多少&nbsp;<BR>
大家是不是老到處走等等來設定&nbsp;<BR>
至於config裡還有一項,swap&nbsp;time,我還真沒搞明白那個unused&nbsp;object是指什麼&nbsp;<BR>
&nbsp;&nbsp;因此也不知道swap具體做什麼事,難道就是從內存移出?&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
像2000這種滅妖系統&nbsp;<BR>
妖會出現的地方老有人走來走去的&nbsp;<BR>
就是把clean&nbsp;up&nbsp;time&nbsp;設為60都很難被destruct&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;那麼設定成多少合適？&nbsp;</I><BR>
︰<I>&nbsp;我暫時改成900了。。可以麼？&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;14:11:14&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
那麼我在clean&nbsp;up裡面也作return_home的工作&nbsp;<BR>
會不會更好一些？&nbsp;<BR>
就是先將不再的npc叫回來然後銷毀房間?&nbsp;<BR>
這樣會有什麼問題麼？？&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;room被clean_up了(destruct),裡面的npc也會被destruct&nbsp;</I><BR>
︰<I>&nbsp;以後有人走來的時候會重新load_object,它set的&nbsp;objects也會重新載入&nbsp;</I><BR>
︰<I>&nbsp;如果原來的npc被人打昏背走或是random&nbsp;move走了,就會出現兩個一樣的npc&nbsp;</I><BR>
︰<I>&nbsp;這跟reset()裡,對npc使用return_home()是不一樣的&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;(一般reset()就幹一件事,npc在mud裡則return_home,不在則new一個,return_home.&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;fy裡,reset還有個清理垃圾的小功能,不過你貼的那一段其實並不好,reset是房間&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;有人的話,會把他面前的物品弄的不翼而飛,這是不合理的,有人在的時候不應該清理&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;垃圾)&nbsp;</I><BR>
︰<I>&nbsp;至於clean&nbsp;up&nbsp;&nbsp;time&nbsp;</I><BR>
︰<I>&nbsp;hehe&nbsp;</I><BR>
︰<I>&nbsp;這個主要是根據你mud裡人的多少&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;spacenet&nbsp;(嚕嚕Q),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;14:16:00&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;呵呵，這麼多討論clean_up和reset的文章，應該放入精華區備查：）&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;room被clean_up了(destruct),裡面的npc也會被destruct&nbsp;</I><BR>
︰<I>&nbsp;以後有人走來的時候會重新load_object,它set的&nbsp;objects也會重新載入&nbsp;</I><BR>
︰<I>&nbsp;如果原來的npc被人打昏背走或是random&nbsp;move走了,就會出現兩個一樣的npc&nbsp;</I><BR>
︰<I>&nbsp;這跟reset()裡,對npc使用return_home()是不一樣的&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;(一般reset()就幹一件事,npc在mud裡則return_home,不在則new一個,return_home.&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;fy裡,reset還有個清理垃圾的小功能,不過你貼的那一段其實並不好,reset是房間&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;有人的話,會把他面前的物品弄的不翼而飛,這是不合理的,有人在的時候不應該清理&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;垃圾)&nbsp;</I><BR>
︰<I>&nbsp;至於clean&nbsp;up&nbsp;&nbsp;time&nbsp;</I><BR>
︰<I>&nbsp;hehe&nbsp;</I><BR>
︰<I>&nbsp;這個主要是根據你mud裡人的多少&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;210.34.9.25]&nbsp;<BR>
發信人:&nbsp;zxf&nbsp;(天堂鳥),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;20:42:27&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
一般來說,&nbsp;如果npc沒有return_home的話,&nbsp;reset()裡&nbsp;<BR>
會add(clean_up,1),&nbsp;來阻止房間被clean_up.&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;那麼我在clean&nbsp;up裡面也作return_home的工作&nbsp;</I><BR>
︰<I>&nbsp;會不會更好一些？&nbsp;</I><BR>
︰<I>&nbsp;就是先將不再的npc叫回來然後銷毀房間?&nbsp;</I><BR>
︰<I>&nbsp;這樣會有什麼問題麼？？&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.119.32.102]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;21:31:46&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
hehe,這個設置造成room的set&nbsp;no_clean_up&nbsp;1沒有用處(reset時先統統設為0,return_home失敗&nbsp;<BR>
&nbsp;&nbsp;失敗add&nbsp;1)&nbsp;<BR>
只好寫個空clean_up()羅&nbsp;<BR>
&nbsp;<BR>
不過他問的還不是這種return_home()失敗的情況&nbsp;<BR>
其實只要不把time&nbsp;to&nbsp;clean&nbsp;up設得比time&nbsp;to&nbsp;reset低的話,就沒問題了&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;zxf&nbsp;(天堂鳥)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;一般來說,&nbsp;如果npc沒有return_home的話,&nbsp;reset()裡&nbsp;</I><BR>
︰<I>&nbsp;會add(clean_up,1),&nbsp;來阻止房間被clean_up.&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Wed&nbsp;Jan&nbsp;&nbsp;3&nbsp;16:07:47&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
我們架設著一個自己的fy改動版本&nbsp;<BR>
遇到了以下的情況希望能夠有人幫忙&nbsp;<BR>
（不知道是不是老問題）&nbsp;<BR>
就是更新問題&nbsp;<BR>
1。房間更新的時候如果npc不在（該npc在別的房間裡，比如random&nbsp;move的）&nbsp;<BR>
&nbsp;&nbsp;&nbsp;並不是呼喚回來而是從新生成（檢查過room.c的reset()函數似乎沒有問題）&nbsp;<BR>
2。玩家的年齡總也不長，（希望知道這個使那裡控制長歲數的，難道是2000年bug）&nbsp;<BR>
&nbsp;&nbsp;&nbsp;我們已經開設了1年多。好像2000年以前沒有這個問題&nbsp;<BR>
&nbsp;<BR>
不知道那位大蝦能幫忙的說&nbsp;<BR>
順便點撥我更新的機理是什麼？就是那裡設定著15分鐘一次的全部更新&nbsp;<BR>
另外這裡付上我們的room.c中的reset()函數&nbsp;<BR>
&nbsp;<BR>
void&nbsp;reset()&nbsp;<BR>
{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mapping&nbsp;ob_list,&nbsp;ob;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;*list;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i,j;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;*inv;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;I&nbsp;put&nbsp;this&nbsp;one&nbsp;here&nbsp;to&nbsp;get&nbsp;rid&nbsp;the&nbsp;function&nbsp;of&nbsp;trash&nbsp;collecting...&nbsp;<BR>
Tie&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;since&nbsp;the&nbsp;quest&nbsp;feature,&nbsp;rooms&nbsp;hardly&nbsp;get&nbsp;swarpped&nbsp;out.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv&nbsp;=&nbsp;all_inventory();&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i=sizeof(inv)-1;&nbsp;i&gt;=0;&nbsp;i--)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(inv[i]-&gt;is_character())&nbsp;continue;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(inv[i]-&gt;query(&quot;no_get&quot;))&nbsp;continue;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(inv[i]-&gt;is_corpse())&nbsp;continue;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destruct(inv[i]);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Check&nbsp;loaded&nbsp;objects&nbsp;to&nbsp;match&nbsp;the&nbsp;objects&nbsp;specified&nbsp;in&nbsp;&quot;objects&quot;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;while&nbsp;query(&quot;objects&quot;)&nbsp;is&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;([&nbsp;&lt;object&nbsp;filename&gt;:&nbsp;&lt;amount&gt;,&nbsp;.....&nbsp;])&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;and&nbsp;query_temp(&quot;objects&quot;)&nbsp;is&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;([&nbsp;&lt;object&nbsp;filename&gt;:&nbsp;({ob1,&nbsp;ob2,&nbsp;...}),&nbsp;....&nbsp;])&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set(&quot;no_clean_up&quot;,&nbsp;0);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob_list&nbsp;=&nbsp;query(&quot;objects&quot;);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!mapp(ob_list)&nbsp;)&nbsp;return;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!mapp(ob&nbsp;=&nbsp;query_temp(&quot;objects&quot;))&nbsp;)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob&nbsp;=&nbsp;allocate_mapping(sizeof(ob_list));&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;=&nbsp;keys(ob_list);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i=0;&nbsp;i&lt;sizeof(list);&nbsp;i++)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Allocate&nbsp;an&nbsp;array&nbsp;if&nbsp;we&nbsp;have&nbsp;multiple&nbsp;same&nbsp;object&nbsp;specified.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;undefinedp(ob[list[i]])&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intp(ob_list[list[i]])&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob_list[list[i]]&nbsp;&gt;&nbsp;1&nbsp;)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob[list[i]]&nbsp;=&nbsp;allocate(ob_list[list[i]]);&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch(ob_list[list[i]])&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;1:&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!ob[list[i]]&nbsp;)&nbsp;ob[list[i]]&nbsp;=&nbsp;make_inventory(list[i]);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;environment(ob[list[i]])&nbsp;!=&nbsp;this_object()&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob[list[i]]-&gt;is_character()&nbsp;)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!ob[list[i]]-&gt;return_home(this_object())&nbsp;)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add(&quot;no_clean_up&quot;,&nbsp;1);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(j=0;&nbsp;j&lt;ob_list[list[i]];&nbsp;j++)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;If&nbsp;the&nbsp;object&nbsp;is&nbsp;gone,&nbsp;make&nbsp;another&nbsp;one.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!objectp(ob[list[i]][j])&nbsp;)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob[list[i]][j]&nbsp;=&nbsp;make_inventory(list[i]);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Try&nbsp;to&nbsp;call&nbsp;the&nbsp;wandering&nbsp;npc&nbsp;come&nbsp;back&nbsp;here.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;environment(ob[list[i]][j])&nbsp;!=&nbsp;this_object()&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob[list[i]][j]-&gt;is_character()&nbsp;)&nbsp;{&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!ob[list[i]][j]-&gt;return_home(this_object())&nbsp;)&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add(&quot;no_clean_up&quot;,&nbsp;1);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_temp(&quot;objects&quot;,&nbsp;ob);&nbsp;<BR>
}&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Wed&nbsp;Jan&nbsp;&nbsp;3&nbsp;18:47:02&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
關於更新看看2471吧&nbsp;<BR>
至於age,由heart_beat()調用update_age()&nbsp;&nbsp;前者在char.c&nbsp;&nbsp;後者在user.c裡&nbsp;<BR>
&nbsp;&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;我們架設著一個自己的fy改動版本&nbsp;</I><BR>
︰<I>&nbsp;遇到了以下的情況希望能夠有人幫忙&nbsp;</I><BR>
︰<I>&nbsp;（不知道是不是老問題）&nbsp;</I><BR>
︰<I>&nbsp;就是更新問題&nbsp;</I><BR>
︰<I>&nbsp;1。房間更新的時候如果npc不在（該npc在別的房間裡，比如random&nbsp;move的）&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;並不是呼喚回來而是從新生成（檢查過room.c的reset()函數似乎沒有問題）&nbsp;</I><BR>
︰<I>&nbsp;2。玩家的年齡總也不長，（希望知道這個使那裡控制長歲數的，難道是2000年bug）&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;我們已經開設了1年多。好像2000年以前沒有這個問題&nbsp;</I><BR>
︰<I>&nbsp;不知道那位大蝦能幫忙的說&nbsp;</I><BR>
︰<I>&nbsp;順便點撥我更新的機理是什麼？就是那裡設定著15分鐘一次的全部更新&nbsp;</I><BR>
︰<I>&nbsp;另外這裡付上我們的room.c中的reset()函數&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Wed&nbsp;Jan&nbsp;&nbsp;3&nbsp;18:59:15&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
可是在xyj2000的裡面房間更新等等卻做得很好&nbsp;<BR>
房間自動更新的時候相關的npc全部被呼喚回來&nbsp;<BR>
而且絕對沒有重複的，即便是克隆都會發現原來的那個貝克隆過來而不是從新生成的&nbsp;<BR>
這是為什麼？？&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;關於更新看看2471吧&nbsp;</I><BR>
︰<I>&nbsp;至於age,由heart_beat()調用update_age()&nbsp;&nbsp;前者在char.c&nbsp;&nbsp;後者在user.c裡&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Wed&nbsp;Jan&nbsp;&nbsp;3&nbsp;23:29:46&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
你隨便找個有npc的房間&nbsp;<BR>
call&nbsp;npc-&gt;command_function(&quot;e&quot;)&nbsp;<BR>
然後再&nbsp;call&nbsp;here-&gt;reset()&nbsp;<BR>
看他是回來了還是重新new了一個&nbsp;<BR>
&nbsp;<BR>
如果回來了,問題就不在reset裡(看那個reset()沒啥問題呀)&nbsp;<BR>
&nbsp;你說的情況有可能是該room被clean_up了&nbsp;<BR>
&nbsp;看看你的config是不是把time&nbsp;to&nbsp;clean&nbsp;up設得過低&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;可是在xyj2000的裡面房間更新等等卻做得很好&nbsp;</I><BR>
︰<I>&nbsp;房間自動更新的時候相關的npc全部被呼喚回來&nbsp;</I><BR>
︰<I>&nbsp;而且絕對沒有重複的，即便是克隆都會發現原來的那個貝克隆過來而不是從新生成的&nbsp;</I><BR>
︰<I>&nbsp;這是為什麼？？&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;09:42:56&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
現在設定的是&nbsp;<BR>
time&nbsp;to&nbsp;clean&nbsp;up&nbsp;:&nbsp;180&nbsp;<BR>
我考慮似乎和這個關係不是很大&nbsp;<BR>
原因是我同時在一個計算機裡面開了2個mud&nbsp;<BR>
一個是xyj2000,一個是fy&nbsp;<BR>
用的相同的config.cfg(我的xyj2000的config是從fy那裡拷貝的）&nbsp;<BR>
唯一不同是設定的服務器端口號碼和對外端口號碼不同&nbsp;<BR>
但是我在xyj2000裡面發現它的更新非常穩定&nbsp;<BR>
並且檢查到它的代碼裡面好像有一個“物品可存在個數”之類的參數&nbsp;<BR>
不過不知道到底怎麼起的作用但顯然的事實是&nbsp;<BR>
當我在xyj2000的十字街頭e一步clone&nbsp;/d/city/npc/libai.c的時候&nbsp;<BR>
發現十字街頭的李白消失了，也就是說李白在mud裡面指存在一個&nbsp;<BR>
而fy則不同我克隆東西的時候原來的東西是仍然存在的&nbsp;<BR>
至於房間reset()的代碼裡面阿鐵添加了一段代碼保證task體系的運行&nbsp;<BR>
這個是唯一和xyj2000不同的地方，是不是這個代碼導致了某些莫名其妙的問題？&nbsp;<BR>
&nbsp;<BR>
另外你所說的call&nbsp;npc-&gt;command_function(&quot;e&quot;)沒有作用的說&nbsp;<BR>
因為那個npc並沒有向東走，我試驗了&nbsp;<BR>
call&nbsp;npc-&gt;command(&quot;east&quot;)&nbsp;<BR>
call&nbsp;npc-&gt;command(&quot;go&nbsp;east&quot;)&nbsp;<BR>
之類的都不可以（當前房間有向東的出口）&nbsp;<BR>
老大再給點提示&nbsp;<BR>
我的先自行研究著先&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;你隨便找個有npc的房間&nbsp;</I><BR>
︰<I>&nbsp;call&nbsp;npc-&gt;command_function(&quot;e&quot;)&nbsp;</I><BR>
︰<I>&nbsp;然後再&nbsp;call&nbsp;here-&gt;reset()&nbsp;</I><BR>
︰<I>&nbsp;看他是回來了還是重新new了一個&nbsp;</I><BR>
︰<I>&nbsp;如果回來了,問題就不在reset裡(看那個reset()沒啥問題呀)&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;你說的情況有可能是該room被clean_up了&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;看看你的config是不是把time&nbsp;to&nbsp;clean&nbsp;up設得過低&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;修改:•mickangel&nbsp;於&nbsp;Jan&nbsp;&nbsp;4&nbsp;09:49:57&nbsp;修改本文•[FROM:&nbsp;&nbsp;&nbsp;&nbsp;202.206.1.31]&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:01:59&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
測試了&nbsp;<BR>
call&nbsp;here-&gt;reset()的時候npc是回來的&nbsp;<BR>
方法是&nbsp;<BR>
衙役跟隨官府的人行動我在衙門門口&nbsp;<BR>
call&nbsp;here-&gt;reset()&nbsp;<BR>
那些衙役回來了（監聽帶走衙役的player看到那些衙役都離開了）&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;現在設定的是&nbsp;</I><BR>
︰<I>&nbsp;time&nbsp;to&nbsp;clean&nbsp;up&nbsp;:&nbsp;180&nbsp;</I><BR>
︰<I>&nbsp;我考慮似乎和這個關係不是很大&nbsp;</I><BR>
︰<I>&nbsp;原因是我同時在一個計算機裡面開了2個mud&nbsp;</I><BR>
︰<I>&nbsp;一個是xyj2000,一個是fy&nbsp;</I><BR>
︰<I>&nbsp;用的相同的config.cfg(我的xyj2000的config是從fy那裡拷貝的）&nbsp;</I><BR>
︰<I>&nbsp;唯一不同是設定的服務器端口號碼和對外端口號碼不同&nbsp;</I><BR>
︰<I>&nbsp;但是我在xyj2000裡面發現它的更新非常穩定&nbsp;</I><BR>
︰<I>&nbsp;並且檢查到它的代碼裡面好像有一個“物品可存在個數”之類的參數&nbsp;</I><BR>
︰<I>&nbsp;不過不知道到底怎麼起的作用但顯然的事實是&nbsp;</I><BR>
︰<I>&nbsp;當我在xyj2000的十字街頭e一步clone&nbsp;/d/city/npc/libai.c的時候&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:14:11&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
clean&nbsp;up&nbsp;&nbsp;time確實低了點&nbsp;&nbsp;一個房間3min沒人去就destruct了&nbsp;<BR>
&nbsp;<BR>
e不行的&nbsp;<BR>
call&nbsp;xxx-&gt;command_function(&quot;east&quot;)試試吧&nbsp;<BR>
call&nbsp;command在有些mud裡是不行的&nbsp;<BR>
&nbsp;<BR>
反正就是把npc弄走,你把他smash了,在別的房間&nbsp;clone一個,再回來call&nbsp;reset()也行呀&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;現在設定的是&nbsp;</I><BR>
︰<I>&nbsp;time&nbsp;to&nbsp;clean&nbsp;up&nbsp;:&nbsp;180&nbsp;</I><BR>
︰<I>&nbsp;我考慮似乎和這個關係不是很大&nbsp;</I><BR>
︰<I>&nbsp;原因是我同時在一個計算機裡面開了2個mud&nbsp;</I><BR>
︰<I>&nbsp;一個是xyj2000,一個是fy&nbsp;</I><BR>
︰<I>&nbsp;用的相同的config.cfg(我的xyj2000的config是從fy那裡拷貝的）&nbsp;</I><BR>
︰<I>&nbsp;唯一不同是設定的服務器端口號碼和對外端口號碼不同&nbsp;</I><BR>
︰<I>&nbsp;但是我在xyj2000裡面發現它的更新非常穩定&nbsp;</I><BR>
︰<I>&nbsp;並且檢查到它的代碼裡面好像有一個“物品可存在個數”之類的參數&nbsp;</I><BR>
︰<I>&nbsp;不過不知道到底怎麼起的作用但顯然的事實是&nbsp;</I><BR>
︰<I>&nbsp;當我在xyj2000的十字街頭e一步clone&nbsp;/d/city/npc/libai.c的時候&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;BigY&nbsp;(懶蟲※馬不停蹄),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:20:14&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;clean&nbsp;up&nbsp;&nbsp;time確實低了點&nbsp;&nbsp;一個房間3min沒人去就destruct了&nbsp;</I><BR>
︰<I>&nbsp;e不行的&nbsp;</I><BR>
︰<I>&nbsp;call&nbsp;xxx-&gt;command_function(&quot;east&quot;)試試吧&nbsp;</I><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;要用go&nbsp;east吧。^^^^^^^^^^^^&nbsp;<BR>
︰<I>&nbsp;call&nbsp;command在有些mud裡是不行的&nbsp;</I><BR>
︰<I>&nbsp;反正就是把npc弄走,你把他smash了,在別的房間&nbsp;clone一個,再回來call&nbsp;reset()也行呀&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
--------------------------------------------------------------------------&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;情深不壽,強極則辱.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;謙謙君子,溫潤如玉.&nbsp;<BR>
--------------------------------------------------------------------------&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.53.170]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:29:51&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
那麼設定成多少合適？&nbsp;<BR>
我暫時改成900了。。可以麼？&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;clean&nbsp;up&nbsp;&nbsp;time確實低了點&nbsp;&nbsp;一個房間3min沒人去就destruct了&nbsp;</I><BR>
︰<I>&nbsp;e不行的&nbsp;</I><BR>
︰<I>&nbsp;call&nbsp;xxx-&gt;command_function(&quot;east&quot;)試試吧&nbsp;</I><BR>
︰<I>&nbsp;call&nbsp;command在有些mud裡是不行的&nbsp;</I><BR>
︰<I>&nbsp;反正就是把npc弄走,你把他smash了,在別的房間&nbsp;clone一個,再回來call&nbsp;reset()也行呀&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;10:58:08&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
e不行,因為npc的指令不調用aliasd.c&nbsp;<BR>
east應該是可以的,command裡發現&quot;exit&quot;裡的東東會自動加go的&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;BigY&nbsp;(懶蟲※馬不停蹄)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;要用go&nbsp;east吧。^^^^^^^^^^^^&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;11:36:22&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
room被clean_up了(destruct),裡面的npc也會被destruct&nbsp;<BR>
以後有人走來的時候會重新load_object,它set的&nbsp;objects也會重新載入&nbsp;<BR>
如果原來的npc被人打昏背走或是random&nbsp;move走了,就會出現兩個一樣的npc&nbsp;<BR>
這跟reset()裡,對npc使用return_home()是不一樣的&nbsp;<BR>
&nbsp;&nbsp;(一般reset()就幹一件事,npc在mud裡則return_home,不在則new一個,return_home.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;fy裡,reset還有個清理垃圾的小功能,不過你貼的那一段其實並不好,reset是房間&nbsp;<BR>
&nbsp;&nbsp;&nbsp;有人的話,會把他面前的物品弄的不翼而飛,這是不合理的,有人在的時候不應該清理&nbsp;<BR>
&nbsp;&nbsp;&nbsp;垃圾)&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
至於clean&nbsp;up&nbsp;&nbsp;time&nbsp;<BR>
hehe&nbsp;<BR>
這個主要是根據你mud裡人的多少&nbsp;<BR>
大家是不是老到處走等等來設定&nbsp;<BR>
至於config裡還有一項,swap&nbsp;time,我還真沒搞明白那個unused&nbsp;object是指什麼&nbsp;<BR>
&nbsp;&nbsp;因此也不知道swap具體做什麼事,難道就是從內存移出?&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
像2000這種滅妖系統&nbsp;<BR>
妖會出現的地方老有人走來走去的&nbsp;<BR>
就是把clean&nbsp;up&nbsp;time&nbsp;設為60都很難被destruct&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;那麼設定成多少合適？&nbsp;</I><BR>
︰<I>&nbsp;我暫時改成900了。。可以麼？&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
發信人:&nbsp;mickangel&nbsp;(二進制),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;14:11:14&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
那麼我在clean&nbsp;up裡面也作return_home的工作&nbsp;<BR>
會不會更好一些？&nbsp;<BR>
就是先將不再的npc叫回來然後銷毀房間?&nbsp;<BR>
這樣會有什麼問題麼？？&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;room被clean_up了(destruct),裡面的npc也會被destruct&nbsp;</I><BR>
︰<I>&nbsp;以後有人走來的時候會重新load_object,它set的&nbsp;objects也會重新載入&nbsp;</I><BR>
︰<I>&nbsp;如果原來的npc被人打昏背走或是random&nbsp;move走了,就會出現兩個一樣的npc&nbsp;</I><BR>
︰<I>&nbsp;這跟reset()裡,對npc使用return_home()是不一樣的&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;(一般reset()就幹一件事,npc在mud裡則return_home,不在則new一個,return_home.&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;fy裡,reset還有個清理垃圾的小功能,不過你貼的那一段其實並不好,reset是房間&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;有人的話,會把他面前的物品弄的不翼而飛,這是不合理的,有人在的時候不應該清理&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;垃圾)&nbsp;</I><BR>
︰<I>&nbsp;至於clean&nbsp;up&nbsp;&nbsp;time&nbsp;</I><BR>
︰<I>&nbsp;hehe&nbsp;</I><BR>
︰<I>&nbsp;這個主要是根據你mud裡人的多少&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.206.1.31]&nbsp;<BR>
發信人:&nbsp;spacenet&nbsp;(嚕嚕Q),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;14:16:00&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;呵呵，這麼多討論clean_up和reset的文章，應該放入精華區備查：）&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;yxrj&nbsp;(遊戲人間)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;room被clean_up了(destruct),裡面的npc也會被destruct&nbsp;</I><BR>
︰<I>&nbsp;以後有人走來的時候會重新load_object,它set的&nbsp;objects也會重新載入&nbsp;</I><BR>
︰<I>&nbsp;如果原來的npc被人打昏背走或是random&nbsp;move走了,就會出現兩個一樣的npc&nbsp;</I><BR>
︰<I>&nbsp;這跟reset()裡,對npc使用return_home()是不一樣的&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;(一般reset()就幹一件事,npc在mud裡則return_home,不在則new一個,return_home.&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;fy裡,reset還有個清理垃圾的小功能,不過你貼的那一段其實並不好,reset是房間&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;有人的話,會把他面前的物品弄的不翼而飛,這是不合理的,有人在的時候不應該清理&nbsp;</I><BR>
︰<I>&nbsp;&nbsp;&nbsp;&nbsp;垃圾)&nbsp;</I><BR>
︰<I>&nbsp;至於clean&nbsp;up&nbsp;&nbsp;time&nbsp;</I><BR>
︰<I>&nbsp;hehe&nbsp;</I><BR>
︰<I>&nbsp;這個主要是根據你mud裡人的多少&nbsp;</I><BR>
︰<I>&nbsp;...................&nbsp;</I><BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;210.34.9.25]&nbsp;<BR>
發信人:&nbsp;zxf&nbsp;(天堂鳥),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;20:42:27&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
一般來說,&nbsp;如果npc沒有return_home的話,&nbsp;reset()裡&nbsp;<BR>
會add(clean_up,1),&nbsp;來阻止房間被clean_up.&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;mickangel&nbsp;(二進制)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;那麼我在clean&nbsp;up裡面也作return_home的工作&nbsp;</I><BR>
︰<I>&nbsp;會不會更好一些？&nbsp;</I><BR>
︰<I>&nbsp;就是先將不再的npc叫回來然後銷毀房間?&nbsp;</I><BR>
︰<I>&nbsp;這樣會有什麼問題麼？？&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;202.119.32.102]&nbsp;<BR>
發信人:&nbsp;yxrj&nbsp;(遊戲人間),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Re:&nbsp;不知道是不是老問題&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Thu&nbsp;Jan&nbsp;&nbsp;4&nbsp;21:31:46&nbsp;2001)&nbsp;<BR>
&nbsp;<BR>
hehe,這個設置造成room的set&nbsp;no_clean_up&nbsp;1沒有用處(reset時先統統設為0,return_home失敗&nbsp;<BR>
&nbsp;&nbsp;失敗add&nbsp;1)&nbsp;<BR>
只好寫個空clean_up()羅&nbsp;<BR>
&nbsp;<BR>
不過他問的還不是這種return_home()失敗的情況&nbsp;<BR>
其實只要不把time&nbsp;to&nbsp;clean&nbsp;up設得比time&nbsp;to&nbsp;reset低的話,就沒問題了&nbsp;<BR>
&nbsp;<BR>
【&nbsp;在&nbsp;zxf&nbsp;(天堂鳥)&nbsp;的大作中提到:&nbsp;】&nbsp;<BR>
︰<I>&nbsp;一般來說,&nbsp;如果npc沒有return_home的話,&nbsp;reset()裡&nbsp;</I><BR>
︰<I>&nbsp;會add(clean_up,1),&nbsp;來阻止房間被clean_up.&nbsp;</I><BR>
&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;smth.org•[FROM:&nbsp;166.111.173.131]&nbsp;<BR>
<A HREF="00000031.htm">上一篇</A>
<A HREF='javascript:history.go(-1)'>返回上一頁</A>
<A HREF="index.htm">回到目錄</A>
<A HREF="#top">回到頁首</A>
</CENTER>
<CENTER><H1>BBS水木清華站︰精華區</H1></CENTER>
</BODY></HTML>