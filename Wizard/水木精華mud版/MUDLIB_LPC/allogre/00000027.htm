<HTML>
<HEAD>
<TITLE>BBS水木清華站︰精華區</TITLE>
</HEAD>
<BODY>
<CENTER><H1>BBS水木清華站︰精華區</H1></CENTER>
<A Name="top"></a>
發信人:&nbsp;sorceress&nbsp;(李大善人~~~以德服人),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Allegro&nbsp;中譯文檔(載入圖片文件)&nbsp;(轉載)&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Mon&nbsp;Jun&nbsp;12&nbsp;20:53:33&nbsp;2000)&nbsp;<BR>
&nbsp;<BR>
【&nbsp;以下文字轉載自&nbsp;GAME_Designer&nbsp;討論區&nbsp;】&nbsp;<BR>
【&nbsp;原文由&nbsp;cloudwu&nbsp;所發表&nbsp;】&nbsp;<BR>
載入圖片文件&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;load_bitmap&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;load_bmp&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;load_lbm&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;load_pcx&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;load_tga&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save_bitmap&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save_bmp&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save_pcx&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save_tga&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register_bitmap_file_type&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_color_conversion&nbsp;&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
警告:&nbsp;當使用真彩圖片時,&nbsp;你必須在載入任何位圖數據前&nbsp;設置圖形模式!&nbsp;否則點格式&nbsp;(RGB&nbsp;<BR>
或&nbsp;BGR)&nbsp;將無法得知,&nbsp;因此文件可能轉換錯誤.&nbsp;&nbsp;<BR>
&nbsp;<BR>
BITMAP&nbsp;*load_bitmap(char&nbsp;*filename,&nbsp;RGB&nbsp;*pal);&nbsp;<BR>
從一個文件裡裝入位圖,&nbsp;返回一個位圖指針並且將&nbsp;調色板數據存到指定的位置,&nbsp;調色板是&nbsp;<BR>
256&nbsp;個&nbsp;RGB&nbsp;結構的數組.&nbsp;你有責任在你使用完它以後釋放掉位圖.&nbsp;如果出錯則返回&nbsp;NULL.&nbsp;<BR>
目前這個函數&nbsp;支持&nbsp;BMP,&nbsp;LBM,&nbsp;PCX,&nbsp;和&nbsp;TGA&nbsp;文件,&nbsp;以文件的後綴來決定類型.&nbsp;如果文件包&nbsp;<BR>
含一個真彩圖片,&nbsp;你必須設置顯示模式&nbsp;或者在裝載圖片前調用&nbsp;set_color_conversion().&nbsp;&nbsp;<BR>
&nbsp;<BR>
BITMAP&nbsp;*load_bmp(char&nbsp;*filename,&nbsp;RGB&nbsp;*pal);&nbsp;<BR>
調入一個&nbsp;Windows&nbsp;或&nbsp;OS/2&nbsp;的&nbsp;256&nbsp;色或&nbsp;24&nbsp;位真彩&nbsp;BMP&nbsp;文件.&nbsp;&nbsp;<BR>
&nbsp;<BR>
BITMAP&nbsp;*load_lbm(char&nbsp;*filename,&nbsp;RGB&nbsp;*pal);&nbsp;<BR>
調入一個&nbsp;256&nbsp;色&nbsp;IFF&nbsp;ILBM/PBM&nbsp;文件.&nbsp;&nbsp;<BR>
&nbsp;<BR>
BITMAP&nbsp;*load_pcx(char&nbsp;*filename,&nbsp;RGB&nbsp;*pal);&nbsp;<BR>
調入一個&nbsp;256&nbsp;色或&nbsp;24&nbsp;位真彩&nbsp;PCX&nbsp;文件.&nbsp;&nbsp;<BR>
&nbsp;<BR>
BITMAP&nbsp;*load_tga(char&nbsp;*filename,&nbsp;RGB&nbsp;*pal);&nbsp;<BR>
調入一個&nbsp;256&nbsp;色,&nbsp;15&nbsp;位高彩,&nbsp;或&nbsp;24&nbsp;位真彩&nbsp;TGA&nbsp;文件.&nbsp;&nbsp;<BR>
&nbsp;<BR>
int&nbsp;save_bitmap(char&nbsp;*filename,&nbsp;BITMAP&nbsp;*bmp,&nbsp;RGB&nbsp;*pal);&nbsp;<BR>
將位圖寫入文件,&nbsp;使用指定的調色板,&nbsp;就是&nbsp;256&nbsp;個&nbsp;RGB&nbsp;結構的調色板.&nbsp;如果出錯則返回非&nbsp;<BR>
零值.&nbsp;輸出&nbsp;格式從文件的後綴檢測到:&nbsp;目前這個&nbsp;函數支持&nbsp;BMP,&nbsp;PCX&nbsp;和&nbsp;TGA&nbsp;格式.&nbsp;一件&nbsp;<BR>
需要提防的事:&nbsp;如果你使用這個來將屏幕拷入文件,可能得到一個&nbsp;比你希望的大的多的圖&nbsp;<BR>
片,&nbsp;因為&nbsp;Allegro&nbsp;經常創建&nbsp;比可見屏幕大的多的虛擬屏幕.&nbsp;你能通過&nbsp;使用一個子位圖來&nbsp;<BR>
指定屏幕的一部分來避免這個問題而保存屏幕,&nbsp;比如:&nbsp;&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BITMAP&nbsp;*bmp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PALETTE&nbsp;pal;&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get_palette(pal);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp&nbsp;=&nbsp;create_sub_bitmap(screen,&nbsp;0,&nbsp;0,&nbsp;SCREEN_W,&nbsp;SCREEN_H);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save_bitmap(&quot;dump.pcx&quot;,&nbsp;bmp,&nbsp;pal);&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destroy_bitmap(bmp);&nbsp;<BR>
&nbsp;<BR>
int&nbsp;save_bmp(char&nbsp;*filename,&nbsp;BITMAP&nbsp;*bmp,&nbsp;RGB&nbsp;*pal);&nbsp;<BR>
將位圖寫到&nbsp;256&nbsp;色&nbsp;或&nbsp;24&nbsp;位真彩&nbsp;BMP&nbsp;文件.&nbsp;&nbsp;<BR>
&nbsp;<BR>
int&nbsp;save_pcx(char&nbsp;*filename,&nbsp;BITMAP&nbsp;*bmp,&nbsp;RGB&nbsp;*pal);&nbsp;<BR>
將位圖寫到&nbsp;256&nbsp;色或&nbsp;24&nbsp;位真彩&nbsp;PCX&nbsp;文件.&nbsp;&nbsp;<BR>
&nbsp;<BR>
int&nbsp;save_tga(char&nbsp;*filename,&nbsp;BITMAP&nbsp;*bmp,&nbsp;RGB&nbsp;*pal);&nbsp;<BR>
將位圖寫到&nbsp;256&nbsp;色,&nbsp;15&nbsp;位高彩,&nbsp;或&nbsp;24&nbsp;位真彩&nbsp;TGA&nbsp;文件.&nbsp;&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
void&nbsp;register_bitmap_file_type(char&nbsp;*ext,&nbsp;BITMAP&nbsp;*(*load)(char&nbsp;*filename,&nbsp;RGB&nbsp;*pal),&nbsp;int&nbsp;<BR>
(*save)(char&nbsp;*filename,&nbsp;BITMAP&nbsp;*bmp,&nbsp;RGB&nbsp;*pal));&nbsp;<BR>
告之&nbsp;load_bitmap()&nbsp;和&nbsp;save_bitmap()&nbsp;函數一個新的文件類型,&nbsp;提供例程用來讀寫這種圖&nbsp;<BR>
片格式&nbsp;(其中某個函數可以為&nbsp;NULL).&nbsp;&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
void&nbsp;set_color_conversion(int&nbsp;mode);&nbsp;<BR>
指定當從外部位圖文件或數據文件裡讀取圖片時,怎樣在&nbsp;有效的顏色深度之間轉換.&nbsp;mode&nbsp;<BR>
是一個&nbsp;指定允許何種轉換類型的位掩碼.&nbsp;如果&nbsp;合適的位被設置,&nbsp;數據將被轉換到當前的點&nbsp;<BR>
格式&nbsp;(由調用&nbsp;set_color_depth()&nbsp;函數來選擇),&nbsp;否則它將&nbsp;保留為磁盤文件中的同一格式,&nbsp;<BR>
把&nbsp;它在顯示之前的轉換工作留給你.&nbsp;缺省模式是&nbsp;全部格式轉換,&nbsp;以便於所有的圖片將以合&nbsp;<BR>
適的&nbsp;格式被載入來適應當前的顯示模式.&nbsp;有效的位標誌有:&nbsp;&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_EXPAND_256&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;擴展&nbsp;256&nbsp;色到真彩&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_REDUCE_TO_256&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;將真彩減少到&nbsp;256&nbsp;色&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_EXPAND_15_TO_16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;擴展&nbsp;15&nbsp;位高彩到&nbsp;16&nbsp;位&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_REDUCE_16_TO_15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;將&nbsp;16&nbsp;位高彩減少到&nbsp;15&nbsp;位&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_EXPAND_HI_TO_TRUE&nbsp;&nbsp;&nbsp;//&nbsp;擴展&nbsp;15/16&nbsp;位到&nbsp;24/32&nbsp;位&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_REDUCE_TRUE_TO_HI&nbsp;&nbsp;&nbsp;//&nbsp;減少&nbsp;24/32&nbsp;位到&nbsp;15/16&nbsp;位&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_24_EQUALS_32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;在&nbsp;24&nbsp;和&nbsp;32&nbsp;位之間轉換&nbsp;<BR>
&nbsp;<BR>
下面這些宏可以用來選擇常用的標誌組合:&nbsp;&nbsp;<BR>
&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_NONE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;關閉所有的格式轉換&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_TOTAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;轉換所有的格式到當前的格式&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_PARTIAL&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;轉換&nbsp;15&nbsp;&lt;-&gt;&nbsp;16&nbsp;和&nbsp;24&nbsp;&lt;-&gt;&nbsp;32&nbsp;位&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLORCONV_MOST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;打開所有的轉換,除了真彩&nbsp;&lt;-&gt;&nbsp;256&nbsp;之間的轉換&nbsp;<BR>
--&nbsp;<BR>
<A HREF="http://www.cfido.net/cloud">http://www.cfido.net/cloud</A>&nbsp;<BR>
<A HREF="http://computer.igd.edu.cn/~cloud">http://computer.igd.edu.cn/~cloud</A>&nbsp;<BR>
<A HREF="http://linux.cqi.com.cn/~cloud">http://linux.cqi.com.cn/~cloud</A>&nbsp;<BR>
<A HREF="http://www.nease.net/~cloudwu">http://www.nease.net/~cloudwu</A>&nbsp;(暫時不能更新)&nbsp;<BR>
E-mail:&nbsp;<A HREF="mailto:cloudwu@263.net">cloudwu@263.net</A>&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;bbs.net.tsinghua.edu.cn•[FROM:&nbsp;202.197.71.16]&nbsp;&nbsp;<BR>
<A HREF="00000026.htm">上一篇</A>
<A HREF='javascript:history.go(-1)'>返回上一頁</A>
<A HREF="index.htm">回到目錄</A>
<A HREF="#top">回到頁首</A>
<A HREF="00000028.htm">下一篇</A>
</H1></CENTER>
<CENTER><H1>BBS水木清華站︰精華區</H1></CENTER>
</BODY></HTML>