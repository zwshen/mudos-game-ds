<HTML>
<HEAD>
<TITLE>BBS水木清華站︰精華區</TITLE>
</HEAD>
<BODY>
<CENTER><H1>BBS水木清華站︰精華區</H1></CENTER>
<A Name="top"></a>
發信人:&nbsp;sorceress&nbsp;(李大善人~~~以德服人),&nbsp;信區:&nbsp;Mud_Builder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>
標&nbsp;&nbsp;題:&nbsp;Allegro&nbsp;遊戲程序庫&nbsp;（使用篇）&nbsp;(轉載)&nbsp;<BR>
發信站:&nbsp;BBS&nbsp;水木清華站&nbsp;(Mon&nbsp;Jun&nbsp;12&nbsp;20:40:35&nbsp;2000)&nbsp;<BR>
&nbsp;<BR>
【&nbsp;以下文字轉載自&nbsp;GAME_Designer&nbsp;討論區&nbsp;】&nbsp;<BR>
【&nbsp;原文由&nbsp;cloudwu&nbsp;所發表&nbsp;】&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;______&nbsp;&nbsp;&nbsp;___&nbsp;&nbsp;&nbsp;&nbsp;___&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;/\&nbsp;&nbsp;_&nbsp;&nbsp;\&nbsp;/\_&nbsp;\&nbsp;&nbsp;/\_&nbsp;\&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;\&nbsp;\L\&nbsp;\\//\&nbsp;\&nbsp;\//\&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__&nbsp;&nbsp;&nbsp;_&nbsp;__&nbsp;&nbsp;&nbsp;___&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;\&nbsp;&nbsp;__&nbsp;\&nbsp;\&nbsp;\&nbsp;\&nbsp;&nbsp;\&nbsp;\&nbsp;\&nbsp;&nbsp;&nbsp;/'__`\&nbsp;/'_&nbsp;`\/\`'__\/&nbsp;__`\&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;\&nbsp;\/\&nbsp;\&nbsp;\_\&nbsp;\_&nbsp;\_\&nbsp;\_/\&nbsp;&nbsp;__//\&nbsp;\L\&nbsp;\&nbsp;\&nbsp;\//\&nbsp;\L\&nbsp;\&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;\_\&nbsp;\_\/\____\/\____\&nbsp;\____\&nbsp;\____&nbsp;\&nbsp;\_\\&nbsp;\____/&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/_/\/_/\/____/\/____/\/____/\/___L\&nbsp;\/_/&nbsp;\/___/&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\____/&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\_/__/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0&nbsp;版&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一個遊戲程序庫&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;Shawn&nbsp;Hargreaves,&nbsp;1994/97&nbsp;<BR>
#include&nbsp;&lt;std_disclaimer.h&gt;&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&quot;我不會接受使用這些代碼所產生的任何不利效果的責任,&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;你想怎麼用這些代碼都可以,&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;這是你自己的冒險&quot;&nbsp;<BR>
=======================================&nbsp;<BR>
============&nbsp;使用&nbsp;&nbsp;Allegro&nbsp;============&nbsp;<BR>
=======================================&nbsp;<BR>
請先閱讀&nbsp;readme.txt&nbsp;裡的一般介紹,版權條款,和&nbsp;<BR>
有關如何編譯&nbsp;Allegro&nbsp;的信息.&nbsp;<BR>
所有的&nbsp;Allegro&nbsp;函數,&nbsp;變量,&nbsp;數據結構都定義在&nbsp;allegro.h&nbsp;裡.&nbsp;<BR>
你必須在你的程序裡包含(include)這個文件,&nbsp;並且連接(link)&nbsp;liballeg.a&nbsp;<BR>
為了做到這些,你必須:&nbsp;<BR>
&nbsp;&nbsp;&nbsp;-&nbsp;將下面這行寫到所有使用了&nbsp;Allegro&nbsp;的&nbsp;C&nbsp;或&nbsp;C++&nbsp;文件的開始:&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#include&nbsp;&lt;allegro.h&gt;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;-&nbsp;如果你在命令行下或利用&nbsp;makefile&nbsp;編譯程序,&nbsp;將&nbsp;'-lalleg'&nbsp;加到&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gcc&nbsp;命令行的末尾,比如:&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gcc&nbsp;foo.c&nbsp;-o&nbsp;foo.exe&nbsp;-lalleg&nbsp;<BR>
&nbsp;&nbsp;&nbsp;-&nbsp;如果你在使用&nbsp;Rhide,&nbsp;選擇&nbsp;Options/Libraries&nbsp;菜單,在&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;空位敲入&nbsp;'alleg',然後將前面的選擇窗選上.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;-&nbsp;如果你不想使用某部分&nbsp;Allegro&nbsp;函數,你可以&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在包含&nbsp;allegro.h&nbsp;前定義下面的任何預處理標誌來稍微的減少你的一點編譯時間:&nbsp;<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_mouse_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_timer_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_keyboard_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_joystick_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_gfx_driver_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_palette_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_graphics_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_vidmem_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_flic_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_sound_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_file_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_datafile_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_math_unused&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alleg_gui_unused&nbsp;<BR>
int&nbsp;allegro_init();&nbsp;<BR>
&nbsp;&nbsp;&nbsp;初始化&nbsp;Allegro&nbsp;庫.&nbsp;它除了&nbsp;<BR>
&nbsp;&nbsp;&nbsp;設置一個全局變量,鎖住一些內存,&nbsp;將&nbsp;allegro_exit()&nbsp;加載到&nbsp;atexit()&nbsp;例程&nbsp;<BR>
&nbsp;&nbsp;&nbsp;上以外沒有做更多的事,但是你必須在做其它事之前調用它.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;成功者返回&nbsp;0&nbsp;(它不可能調用失敗,所以&nbsp;<BR>
&nbsp;&nbsp;&nbsp;沒有更多的返回值).&nbsp;<BR>
void&nbsp;allegro_exit();&nbsp;<BR>
&nbsp;&nbsp;&nbsp;關閉&nbsp;Allegro&nbsp;系統.&nbsp;這包括將系統返回到文本模式,&nbsp;<BR>
&nbsp;&nbsp;&nbsp;卸載裝載過的鼠標,鍵盤,時鐘例程.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;一般你不必去明顯的去調用它,&nbsp;<BR>
&nbsp;&nbsp;&nbsp;因為&nbsp;allegro_init()&nbsp;將它作為&nbsp;atexit()&nbsp;例程加載了,&nbsp;<BR>
&nbsp;&nbsp;&nbsp;所以它將在你的程序退出時自動被調用.&nbsp;<BR>
extern&nbsp;char&nbsp;allegro_id[];&nbsp;<BR>
&nbsp;&nbsp;&nbsp;一個包含有庫的日期和版本信息的字符串,&nbsp;<BR>
&nbsp;&nbsp;&nbsp;也許你在某些地方回用到這些.&nbsp;<BR>
extern&nbsp;char&nbsp;allegro_error[];&nbsp;<BR>
&nbsp;&nbsp;&nbsp;一個被&nbsp;set_gfx_mode()&nbsp;和&nbsp;install_sound()&nbsp;用來報告錯誤信息的字符串.&nbsp;<BR>
&nbsp;&nbsp;&nbsp;如果這些函數調用失敗而你想告訴用戶是為什麼,在這裡&nbsp;<BR>
&nbsp;&nbsp;&nbsp;能找到有關問題的描述.&nbsp;<BR>
extern&nbsp;int&nbsp;os_type;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;由&nbsp;allegro_init()&nbsp;設置成以下值中的一個:&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSTYPE_UNKNOWN&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;未知,&nbsp;或常規的&nbsp;MSDOS&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSTYPE_WIN3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;3.1&nbsp;或更早的版本&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSTYPE_WIN95&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;95&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSTYPE_WINNT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;NT&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSTYPE_OS2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;OS/2&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSTYPE_WARP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;OS/2&nbsp;Warp&nbsp;3&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSTYPE_DOSEMU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Linux&nbsp;DOSEMU&nbsp;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSTYPE_OPENDOS&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Caldera&nbsp;OpenDOS&nbsp;<BR>
extern&nbsp;int&nbsp;windows_version,&nbsp;windows_sub_version;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;由&nbsp;allegro_init()&nbsp;設置,&nbsp;使用&nbsp;int&nbsp;0x2F,&nbsp;ax=0x1600&nbsp;來檢測&nbsp;<BR>
&nbsp;&nbsp;&nbsp;當前的&nbsp;Microsoft&nbsp;Windows.&nbsp;在&nbsp;windows&nbsp;3.1&nbsp;下,&nbsp;windows_version&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;將被設為&nbsp;3,&nbsp;在&nbsp;win95&nbsp;下則是&nbsp;4,&nbsp;在&nbsp;NT&nbsp;在將是&nbsp;0x100,&nbsp;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;如果沒有運行在&nbsp;windows&nbsp;下則為&nbsp;0.&nbsp;在&nbsp;Linux&nbsp;DOSEMU&nbsp;下,&nbsp;兩個變量&nbsp;<BR>
&nbsp;&nbsp;&nbsp;都將被設為&nbsp;-1.&nbsp;<BR>
void&nbsp;check_cpu();&nbsp;<BR>
&nbsp;&nbsp;&nbsp;檢測&nbsp;CPU&nbsp;型號,&nbsp;設置以下的全局變量:&nbsp;<BR>
extern&nbsp;char&nbsp;cpu_vendor[];&nbsp;<BR>
&nbsp;&nbsp;&nbsp;如果可能,由&nbsp;check_cpu()&nbsp;設置成&nbsp;CPU&nbsp;廠商的名字.&nbsp;<BR>
extern&nbsp;int&nbsp;cpu_family;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;由&nbsp;check_cpu()&nbsp;設置成&nbsp;CPU&nbsp;型號:&nbsp;3=386,&nbsp;4=486,&nbsp;5=Pentium,&nbsp;6=PPro,&nbsp;等等.&nbsp;<BR>
extern&nbsp;int&nbsp;cpu_model;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;由&nbsp;check_cpu()&nbsp;設置成&nbsp;CPU&nbsp;子類型.&nbsp;如果是&nbsp;386&nbsp;(cpu_family=3),&nbsp;<BR>
&nbsp;&nbsp;&nbsp;0&nbsp;表示&nbsp;DX&nbsp;芯片,&nbsp;2&nbsp;表示&nbsp;SX,&nbsp;4&nbsp;表示&nbsp;SL,&nbsp;15&nbsp;表示未知.&nbsp;如果是&nbsp;486&nbsp;<BR>
&nbsp;&nbsp;&nbsp;(cpu_family=4),&nbsp;0&nbsp;或&nbsp;1&nbsp;表示&nbsp;DX&nbsp;芯片,&nbsp;2&nbsp;表示&nbsp;SX,&nbsp;3&nbsp;表示&nbsp;487&nbsp;(SX)&nbsp;或&nbsp;<BR>
&nbsp;&nbsp;&nbsp;486&nbsp;DX,&nbsp;4&nbsp;表示&nbsp;SL,&nbsp;5&nbsp;表示&nbsp;SX2,&nbsp;7&nbsp;表示&nbsp;DX2&nbsp;write-back&nbsp;enhanced,&nbsp;8&nbsp;表示&nbsp;DX4&nbsp;<BR>
&nbsp;&nbsp;&nbsp;或&nbsp;DX4&nbsp;overdrive,&nbsp;14&nbsp;表示&nbsp;Cyrix,&nbsp;15&nbsp;表示未知.&nbsp;如果是奔騰芯片&nbsp;<BR>
&nbsp;&nbsp;&nbsp;(cpu_family==5),&nbsp;1&nbsp;表示&nbsp;Pentium&nbsp;(510\66,567\66),&nbsp;2&nbsp;表示&nbsp;Pentium&nbsp;P54C,&nbsp;<BR>
&nbsp;&nbsp;&nbsp;3&nbsp;表示&nbsp;Pentium&nbsp;overdrive&nbsp;processor,&nbsp;5&nbsp;表示&nbsp;Pentium&nbsp;overdrive&nbsp;for&nbsp;<BR>
&nbsp;&nbsp;&nbsp;InterDX4,&nbsp;14&nbsp;表示&nbsp;Cyrix,&nbsp;15&nbsp;表示未知.&nbsp;<BR>
extern&nbsp;int&nbsp;cpu_fpu;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;由&nbsp;check_cpu()&nbsp;設置成&nbsp;TRUE&nbsp;或&nbsp;FALSE,&nbsp;這個值依賴於有無一個浮點運算器&nbsp;<BR>
&nbsp;&nbsp;&nbsp;能夠被利用.&nbsp;<BR>
extern&nbsp;int&nbsp;cpu_mmx;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;由&nbsp;check_cpu()&nbsp;設置成&nbsp;TRUE&nbsp;或&nbsp;FALSE,&nbsp;這個值依賴於是否有&nbsp;MMX&nbsp;<BR>
&nbsp;&nbsp;&nbsp;指令可以被利用.&nbsp;<BR>
extern&nbsp;int&nbsp;cpu_cpuid;&nbsp;<BR>
&nbsp;&nbsp;&nbsp;由&nbsp;check_cpu()&nbsp;設置成&nbsp;TRUE&nbsp;或&nbsp;FALSE,&nbsp;這個值取決於&nbsp;&quot;cpuid&quot;&nbsp;指令&nbsp;<BR>
&nbsp;&nbsp;&nbsp;是否能被利用.&nbsp;(如果它被設置,&nbsp;其它的&nbsp;CPU&nbsp;變量&nbsp;<BR>
&nbsp;&nbsp;&nbsp;100%&nbsp;可信,&nbsp;否則某些地方可能出了問題).&nbsp;<BR>
&nbsp;<BR>
--&nbsp;<BR>
<A HREF="http://www.nease.net/~cloudwu">http://www.nease.net/~cloudwu</A>&nbsp;<BR>
<A HREF="http://computer.igd.edu.cn/~cloud">http://computer.igd.edu.cn/~cloud</A>&nbsp;<BR>
E-mail:&nbsp;<A HREF="mailto:cloudwu@163.net">cloudwu@163.net</A>&nbsp;<BR>
&nbsp;<BR>
※&nbsp;來源:•BBS&nbsp;水木清華站&nbsp;bbs.net.tsinghua.edu.cn•[FROM:&nbsp;202.197.71.12]&nbsp;<BR>
<A HREF="00000000.htm">上一篇</A>
<A HREF='javascript:history.go(-1)'>返回上一頁</A>
<A HREF="index.htm">回到目錄</A>
<A HREF="#top">回到頁首</A>
<A HREF="00000002.htm">下一篇</A>
</H1></CENTER>
<CENTER><H1>BBS水木清華站︰精華區</H1></CENTER>
</BODY></HTML>