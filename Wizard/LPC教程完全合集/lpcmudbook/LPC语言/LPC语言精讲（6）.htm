
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>网虫乐园--泥潭风云</TITLE>
<META content="MSHTML 5.00.2919.6307" name=GENERATOR>
<META content=TLT name=Author>
<META content=text/html;charset=gb2312 http-equiv=content-type>
<style>
<!--      
A:link {text-decoration: none;color:blue}       
.105V         {font-size: 10.5pt; font-family: 宋体;}
TD          {font-size: 9pt; font-family: 宋体;}
.90V         {font-size: 9pt; font-family: 宋体;}
.90VE         {font-size: 9pt; font-family: arial;}
A:hover      {text-decoration: none;color:red;}
A:visited  {text-decoration: none;}
A:active     {text-decoration: none;color:#ff0000}
-->
</style>


<script>
<!--
lstart=50
loop=true
speed=350 
pr_step=5 

function makeObj(obj,nest){
nest=(!nest) ? '':'document.'+nest+'.'
this.css=(document.layers) ? eval(nest+'document.'+obj):eval(obj+'.style')
    this.scrollHeight=document.layers?this.css.document.height:eval(obj+'.offsetHeight')
    this.up=goUp
this.obj = obj + "Object"
eval(this.obj + "=this")
return this
}
function goUp(speed){
    if(parseInt(this.css.top)>-this.scrollHeight){
        this.css.top=parseInt(this.css.top)-pr_step
        setTimeout(this.obj+".up("+speed+")",speed)
    }else if(loop) {
        this.css.top=lstart
        eval(this.obj+".up("+speed+")")
    }
}
function slideInit(){
    oSlide=makeObj('divNews','divCont')
    oSlide.css.top=lstart
    oSlide.up(speed)
}
onload=slideInit
//-->
</script></head>

<body aLink="#660033" bgColor="#ffffff" leftMargin="0" text=darkgreen link="#000066" vLink="#000066"
topMargin="0" >
<div align="center"><center>
   <table border="1" width="776" borderColor=#ffffff borderColorLight=#ab9c36  align="center" bgColor=#f0f3dc cellPadding=0 cellSpacing=0 >
      <tr>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/home.gif width=15 height=15><a href=http://202.114.98.14/>网虫乐园首页</a></td> 
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/soft.gif height=15 width=15 border=0><a href="http://202.114.98.12/softroom/">软件大观园</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/mud.gif height=15 width=15 border=0><a href="http://202.114.98.14/mud/">泥潭风云</font></a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/freeweb.gif height=15 width=15 border=0><a href="http://202.114.98.14/freeweb/">个人主页空间</a></td>  
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/bbs.gif height=15 width=15 border=0><a href=http://202.114.98.14/bbs/>网虫社区</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/webresource.gif height=15 width=15 border=0><a href="http://202.114.98.14/webresource/">Web资源角</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/show.gif height=15 width=15 border=0><a href="#" onclick="window.open('http://202.114.98.14/show/','','menubar=no,toolbar=no,location=no,directories=no,status=no,resizable=1,scrollbars=1,width=800,height=600,top=0,left=0');">秀网珍藏</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/links1.gif height=15 width=15 border=0><a href=http://202.114.98.14/links/>友情链接</a></td>
      </tr>
    </table></center>

<table bgcolor=white width=770 border=1 borderColor=#ffffff borderColorLight=#ab9c36   cellpadding=0 cellspacing=0>
   <tr><td><table bgcolor=white width=770 border=0 cellpadding=0 cellspacing=0>
   <tr><td width=180 height=60><img src=http://202.114.98.14/images/netbugs1.gif width=180 height=60></td>
   <td align=center width=468 valign=center  bgcolor=white><script src="http://202.114.98.14/ad1.js" width=468 height=60 border=0></script></td>
   <td width=112 bgcolor=white><div id="divCont"
style="position:absolute; width:110; height:60; top:25; left:660; clip:rect(0,110,60,0)"><div
id="divNews" style="position:absolute; top:0; left:0">

<p>欢迎光临网虫乐园！<a href=http://202.114.98.14/>首页</a>有网站各子站最新变动介绍和
教育网酷站连接。<p><a href=http://202.114.98.12/softroom/>软件大观园</a>每日更新；收藏3G软件，均为最新版本。
<p><a href=http://202.114.98.14/mud>泥潭风云</a>是教育网内最大的mud站点；<a href=http://202.114.98.14/webresource>Web资源角</a>有三千多动画和背景为你网页增添色彩。
<p><a href=http://202.114.98.14/freeweb/>10M免费个人主页空间</a>，ftp维护；申请三日内批准。<p><a href=http://202.114.98.14/show>秀网珍藏</a>图片近2G，栏目众多，包罗万象，每日都有大量图片增加。
<p>对我们网站的建设的建议欢迎<a href=mailto:softroom@wuhee.edu.cn>来信</a>或写在<a href=http://202.114.98.14/bbs>社区</a>内。</p>
</div></div>
</td>
   </tr>
   </table>
</td></tr></table>

<center>
   <table border="1" width="770" borderColor=#ffffff borderColorLight=#ab9c36  align="center" bgColor=#f0f3dc cellPadding=0 cellSpacing=0 >
      <tr>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/index.htm">首页</A></td> 
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/newcomer/">泥巴入门</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/player/">泥巴进阶</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/source/">泥巴资源</A></td>  
        <td align="center" width="96"><P align=center><A 
        href="http://202.114.98.14/mud/pmud/">图形泥巴</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/mudlife/">泥巴人生</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/wiz/">巫师乐园</FONT></A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/download/">软件下载</A>            <SCRIPT>
   document.write("<a href=http://webpub.au.tsinghua.edu.cn/count/count.dll?Type=Basic&id=2138&ReferID=2138 target=_blank>");
   document.write("<img src=http://webpub.au.tsinghua.edu.cn/count/count.dll?Type=Img2&add=1&id=2138&refer="+escape(top.document.referrer)+" border=0 alt=酷站今日访问 width=12 height=12>");
   </SCRIPT></td>

      </tr>
    </table></center>
    


<table border="0" width="100%" style="color: rgb(255,255,0)" cellspacing="0" cellpadding="0">
  <tr>
    <td width="8%" rowspan="4"></td>
    <td width="83%"><p align="center"><font color="#000000">LPC语言<br>
    ―――――――――――――――――――――<br>
    <font size="2">综合地介绍MUD编程语言（LPC）<br>
    ―――――――――――――――――――――――――</font></font></td>
    <td width="9%" rowspan="4"></td>
  </tr>
  <tr>
    <td width="83%"><p align="center"><font color="#000000">LPC语言精讲（6）</td>
  </tr>
  <tr>
    <td width="83%"><font color="#000000">第三章 Lpc的函数<br>
    第一节 序言<br>
    在前面的介绍中，大家应该知道了Lpc的Object包含能处理变量的函数。当函数被执行时，它的工作就是处理操作变量，还有是调用(call)别的函数。变量在函数中被改变操作。变量必须有个数据类型使得计算机能明白它指向的内存中&quot;0&quot;和&quot;1&quot;到底是什么东西。一个Object的性质通常由它的包含的变量确定，但是它的特性的表现却是依赖于它包含的函数。一个Object如果不含有任何一个函数那是不可想象的。那么：什么是函数。<br>
    第二节 函数<br>
    2.1 什么是函数？<br>
    和数学的函数一样，你给Lpc的函数一个值，它能返回一个值。有些语言，比如Pascal，会区分过程和函数。Lpc和C/C++一样，没有过程，但是明白这种区别还是有用的。Pascal叫做过程的东西，Lpc叫做类型是void的函数。换句话说，过程就是什么都不返回的函数。Pascal叫做函数的，必须返回一些东西。在Lpc中，最无聊的，最简单的，但也是正确的函数是这样的：<br>
    -----<br>
    void eventDoNothing() {}<br>
    -----<br>
    这个函数不接收任何输入，不执行指令，也不返回任何值。<br>
    每一个Lpc函数都由三部分组成：<br>
    1) 函数声明<br>
    2) 函数定义<br>
    3) 函数调用<br>
    和变量一样，函数必须先有个声明。这样可以让Driver知道：<br>
    1) 这个函数将返回的是哪种数据类型。<br>
    2) 需要的输入是什么，多少。通常把输入叫做参数。<br>
    一个函数声明通常是这样的：<br>
    类型 函数名(参数1, 参数2, ..., 参数N);<br>
    下面是一个函数声明的例子，这个函数叫 DrinkWater，有一个string类型的参数，返回的是一个int。<br>
    -----<br>
    int eventDrinkWater(string str);<br>
    -----<br>
    在上面的声明中, str是输入的参数的变量名，也可以没有。就是说可以象下面这样声明 
    eventDrinkWater()<br>
    -----<br>
    int eventDrinkWater(string);<br>
    -----<br>
    函数定义就是代码，它描述了这个函数对传人的参数究竟做了些什么。函数调用就是别的函数在任何地方使用执行了这个函数。一个函数在它写完后永远不会被调用，那这个函数的存在的唯一意义只能是浪费内存和硬盘。一个函数写出来的目的是为了被调用。下面是两个函数相互调用的例子，两个函数是eventPrintValue() 
    和add(),<br>
    -----<br>
    /* 首先是函数声明，这个通常是在一个Object的开始部分。<br>
    */<br>
    void eventPrintValue();<br>
    int add(int x, int y);<br>
    /* 其次是函数 write_vals() 的函数定义。我们假定这个函数将被调用<br>
    * 是为了描述这个Object.<br>
    */<br>
    void eventPrintValue()<br>
    {<br>
    int x;<br>
    x = add(2, 2); // 我们指定 x 接收调用函数 add() 后返回的值。<br>
    write(x + &quot;\n&quot;);<br>
    }<br>
    /* 最后是函数 add() 的函数定义。 */<br>
    int add(int x, int y)<br>
    {<br>
    return (x + y);<br>
    }<br>
    -----<br>
    有一点是指明的，在XO的编程的风格我们要求所有的函数都必须有声明，这个在我们最开始时候说明过。但是实际上必须有函数声明的函数是那些被调用在函数定义之前的函数。我们规定必须有函数声明，这个只是规定，但是它会给编程带来好处。<br>
    在这一节我们知道什么是函数，函数是由什么组成。要记住，写一个函数的根本目的是为用它，调用它。一个函数永远不会被调用，那它就失去了存在的价值。通常别人使用你写的函数，通常只关心它能对传人的参数做些什么加工，就是这个函数的功能是什么，返回什么。因此一个函数有一个好的函数名，能直接描述这个函数的功能是很重要的。我在第一章中说明了XO规定的对函数的命名机制。采用统一的命名方式有助于相互合作提高效率。<br>
    2.2 Efuns<br>
    也许你已经听说过efun这个词了，他们是外部定义的函数，是<br>
    externally defined function 的缩写。就是说，他们是由Mud Driver定义好的。如果参加过Lpc的编程，或者看过Lpc的代码，你可能找到这样的一些表达式：this_player(), 
    strcmp(), implode(), filter()，等等，看起来象是一个函数，而你找遍整个Object以及这个Object继承的所有Object中都没有这些函数，这就表明他们是efun。efun存在价值是因为他们执行起来要比一般的Object带有的函数速度快的多，为什么快呢，因为他们是以计算机直接能理解的二进制的形式存在。对于Object内部定义的函数，我们通常叫他们是lfun(local 
    function)。一个巫师主要工作也就是编写一些lfun组成的Object。在上面的例子中的 
    eventPrintValue() 中调用了两个函数，第一个是函数 add(), 
    这个是有你声明和定义的，这个就是lfun。第二次调用，是调用函数 
    write() 这个函数通常就是efun。Driver已经替你声明和定义好了。你所要做只是调用它。<br>
    efun被创立是为了<br>
    1) 处理一些很常用的，每天都有许多函数会调用的。<br>
    2) 处理internet socket的输入输出。<br>
    3) 以及一些Lpc很难处理的事，毕竟Lpc是C的很小的子集。<br>
    efun是用C写好的，内嵌在Driver里面的。在Mud起来之前，和Driver一起编译好的，他们执行起来会快的多。但是正和你期望的一样，他们的调用和你写的函数的调用方法是完全一样的。总的来说，需要关心的和一般函数一样，它需要传入什么参数，它将会返回什么的东西。<br>
    怎样得到一些efun的信息，比如传入参数和返回的类型，通常在一个Mud里面，你可以在类似这样的 
    /doc/efun 的目录底下找到，或者直接用 help 指令就可以得到帮助。efun及其依赖于你所在的Mud的Driver，不同的Driver带有的efun区别是很大。对于XO，使用的是MudOS，一般的efun，只要用 
    help 
    指令就能得到帮助，或者你多看看源码，看看别人是怎样使用的，当然你如果无论如何也不能明白一个efun，你可以问问大巫师，他们通常会很乐意和你探讨的。但是有一点是指出，能自己解决的问题最好自己解决。</small></td>
  </tr>
  <tr>
    <td width="83%"><p align="center"><a href="lpc_5.asp">上一篇</a> 
    &nbsp;&nbsp;&nbsp;&nbsp; <a href="lpc_7.asp">下一篇</a></td>
  </tr>
</table>
   <TABLE border=0 cellPadding=0 cellSpacing=0 width=730>
  <TBODY>
  <TR>
    <TD bgColor=#000033 colSpan=3 height=2>
    </TD>
  </TR>
  </TBODY>
</TABLE>
<P>
<CENTER><FONT color=#919191 face=ARIAL,HELVETICA size=-1>对我们网站的建议和合作请与<A 
href="mailto:softroom@wuhee.edu.cn">mailto:softroom@wuhee.edu.cn</A>联系.<BR><BR>Copyright 
(C) 2000 网虫乐园工作室.<script src="http://202.114.98.14/count.js" width=468 height=60 border=0></script></FONT>
<P></P></CENTER></CENTER></CENTER></DIV></BODY></HTML>
