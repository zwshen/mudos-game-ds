
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>网虫乐园--泥潭风云</TITLE>
<META content="MSHTML 5.00.2919.6307" name=GENERATOR>
<META content=TLT name=Author>
<META content=text/html;charset=gb2312 http-equiv=content-type>
<style>
<!--      
A:link {text-decoration: none;color:blue}       
.105V         {font-size: 10.5pt; font-family: 宋体;}
TD          {font-size: 9pt; font-family: 宋体;}
.90V         {font-size: 9pt; font-family: 宋体;}
.90VE         {font-size: 9pt; font-family: arial;}
A:hover      {text-decoration: none;color:red;}
A:visited  {text-decoration: none;}
A:active     {text-decoration: none;color:#ff0000}
-->
</style>


<script>
<!--
lstart=50
loop=true
speed=350 
pr_step=5 

function makeObj(obj,nest){
nest=(!nest) ? '':'document.'+nest+'.'
this.css=(document.layers) ? eval(nest+'document.'+obj):eval(obj+'.style')
    this.scrollHeight=document.layers?this.css.document.height:eval(obj+'.offsetHeight')
    this.up=goUp
this.obj = obj + "Object"
eval(this.obj + "=this")
return this
}
function goUp(speed){
    if(parseInt(this.css.top)>-this.scrollHeight){
        this.css.top=parseInt(this.css.top)-pr_step
        setTimeout(this.obj+".up("+speed+")",speed)
    }else if(loop) {
        this.css.top=lstart
        eval(this.obj+".up("+speed+")")
    }
}
function slideInit(){
    oSlide=makeObj('divNews','divCont')
    oSlide.css.top=lstart
    oSlide.up(speed)
}
onload=slideInit
//-->
</script></head>

<body aLink="#660033" bgColor="#ffffff" leftMargin="0" text=darkgreen link="#000066" vLink="#000066"
topMargin="0" >
<div align="center"><center>
   <table border="1" width="776" borderColor=#ffffff borderColorLight=#ab9c36  align="center" bgColor=#f0f3dc cellPadding=0 cellSpacing=0 >
      <tr>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/home.gif width=15 height=15><a href=http://202.114.98.14/>网虫乐园首页</a></td> 
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/soft.gif height=15 width=15 border=0><a href="http://202.114.98.12/softroom/">软件大观园</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/mud.gif height=15 width=15 border=0><a href="http://202.114.98.14/mud/">泥潭风云</font></a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/freeweb.gif height=15 width=15 border=0><a href="http://202.114.98.14/freeweb/">个人主页空间</a></td>  
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/bbs.gif height=15 width=15 border=0><a href=http://202.114.98.14/bbs/>网虫社区</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/webresource.gif height=15 width=15 border=0><a href="http://202.114.98.14/webresource/">Web资源角</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/show.gif height=15 width=15 border=0><a href="#" onclick="window.open('http://202.114.98.14/show/','','menubar=no,toolbar=no,location=no,directories=no,status=no,resizable=1,scrollbars=1,width=800,height=600,top=0,left=0');">秀网珍藏</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/links1.gif height=15 width=15 border=0><a href=http://202.114.98.14/links/>友情链接</a></td>
      </tr>
    </table></center>

<table bgcolor=white width=770 border=1 borderColor=#ffffff borderColorLight=#ab9c36   cellpadding=0 cellspacing=0>
   <tr><td><table bgcolor=white width=770 border=0 cellpadding=0 cellspacing=0>
   <tr><td width=180 height=60><img src=http://202.114.98.14/images/netbugs1.gif width=180 height=60></td>
   <td align=center width=468 valign=center  bgcolor=white><script src="http://202.114.98.14/ad1.js" width=468 height=60 border=0></script></td>
   <td width=112 bgcolor=white><div id="divCont"
style="position:absolute; width:110; height:60; top:25; left:660; clip:rect(0,110,60,0)"><div
id="divNews" style="position:absolute; top:0; left:0">

<p>欢迎光临网虫乐园！<a href=http://202.114.98.14/>首页</a>有网站各子站最新变动介绍和
教育网酷站连接。<p><a href=http://202.114.98.12/softroom/>软件大观园</a>每日更新；收藏3G软件，均为最新版本。
<p><a href=http://202.114.98.14/mud>泥潭风云</a>是教育网内最大的mud站点；<a href=http://202.114.98.14/webresource>Web资源角</a>有三千多动画和背景为你网页增添色彩。
<p><a href=http://202.114.98.14/freeweb/>10M免费个人主页空间</a>，ftp维护；申请三日内批准。<p><a href=http://202.114.98.14/show>秀网珍藏</a>图片近2G，栏目众多，包罗万象，每日都有大量图片增加。
<p>对我们网站的建设的建议欢迎<a href=mailto:softroom@wuhee.edu.cn>来信</a>或写在<a href=http://202.114.98.14/bbs>社区</a>内。</p>
</div></div>
</td>
   </tr>
   </table>
</td></tr></table>

<center>
   <table border="1" width="770" borderColor=#ffffff borderColorLight=#ab9c36  align="center" bgColor=#f0f3dc cellPadding=0 cellSpacing=0 >
      <tr>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/index.htm">首页</A></td> 
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/newcomer/">泥巴入门</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/player/">泥巴进阶</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/source/">泥巴资源</A></td>  
        <td align="center" width="96"><P align=center><A 
        href="http://202.114.98.14/mud/pmud/">图形泥巴</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/mudlife/">泥巴人生</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/wiz/">巫师乐园</FONT></A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/download/">软件下载</A>            <SCRIPT>
   document.write("<a href=http://webpub.au.tsinghua.edu.cn/count/count.dll?Type=Basic&id=2138&ReferID=2138 target=_blank>");
   document.write("<img src=http://webpub.au.tsinghua.edu.cn/count/count.dll?Type=Img2&add=1&id=2138&refer="+escape(top.document.referrer)+" border=0 alt=酷站今日访问 width=12 height=12>");
   </SCRIPT></td>

      </tr>
    </table></center>
    


<table border="0" width="100%" style="color: rgb(255,255,0)" cellspacing="0" cellpadding="0">
  <tr>
    <td width="8%" rowspan="4"></td>
    <td width="83%"><p align="center"><font color="#000000">LPC语言<br>
    ―――――――――――――――――――――<br>
    <font size="2">综合地介绍MUD编程语言（LPC）<br>
    ―――――――――――――――――――――――――</font></font></td>
    <td width="9%" rowspan="4"></td>
  </tr>
  <tr>
    <td width="83%"><p align="center"><font color="#000000">LPC语言精讲（9）</td>
  </tr>
  <tr>
    <td width="83%"><font color="#000000">第五章 变量控制和流程控制<br>
    第一节 序言<br>
    到今天，你应该能自己编写一些简单的 Object 了，通过使用你所在的 
    Mud 的标准的 Object 库。 
    你应该知道什么是继承了，还有你应该能自己写一些函数来表现你自己的 
    Object 特有的性质了。在这一章，你将知道 Lpc 
    的最基本的一些元素，比如：表达式、操作符等，在你自己写的函数通过一些基本元素的组合来操纵变量，通过流程控制来使的你的函数更为复杂，而不是线性执行到最后。<br>
    第二节 变量<br>
    2.1 值和变量<br>
    从根本来说，任意两个 Object 不同的地方有两个方面：<br>
    1) 一些函数不同<br>
    2) 各个变量的值不同<br>
    举个例子，所有的玩家 Object 
    有完全一样的函数。因此他们不同的只是保持的值不同。比如，玩家名字叫做 
    &quot;falcon&quot; 和 &quot;trill&quot; 不同，其最根本的不同的是因为变量 
    &quot;dbase/id&quot; 这个值不同，一个是&quot;falcon&quot;另一个是 
    &quot;trill&quot; 。因此，在 Mud 中的变化就是各个 Object 
    中的值的变化。函数是用来命名那些可以改变操纵变量的特殊的一些过程。举个例子，函数create()就是这样一个过程：初始化一个 
    Object 
    的各个变量的值的一个过程。在函数里面，有个特别的东西叫做 
    指令 用于直接改变操纵变量。<br>
    2.2 局部和全局变量<br>
    和大多数的编程语言一样，Lpc 
    的变量可以被声明成一个函数的局部变量，也可以是全局变量(这个全局变量只在一个Object 
    内部是全局的，对于其他 Object 的函数是不能访问的)。局部变量在一个函数定义内部声明，只在这个函数内部使用。别的函数无法得知它的存在。全部变量则只要所在的 
    Object 存在时间内，可以被这个 Obejct 
    声明的任何函数调用，就是它一直在内存中存在。看看下面的两个例子：<br>
    -----<br>
    int x;<br>
    int GetX()<br>
    {<br>
    return x;<br>
    }<br>
    void SetX( int y )<br>
    {<br>
    x = y;<br>
    }<br>
    -----<br>
    -----<br>
    void SetX( int y )<br>
    {<br>
    int x;<br>
    x = y;<br>
    write( &quot;x is set to x&quot; + x + &quot; and will now be forgotten.\n&quot; );<br>
    }<br>
    -----<br>
    在第一个例子里面，x 
    在所有的函数的外部声明，所以它可以被它后面的任何函数使用。在这个例子中，x 
    就是一个全局变量。<br>
    在第二个例子中，x 在函数 SetX() 的内部声明。它只有在函数 SetX()被执行时才存在。然后，它就消失了。在这个例子中，x 
    是局部变量。<br>
    2.2 表达式和操作符<br>
    在 Lpc 中表达式和操作符的意义和 C/C++ 
    的完全一样，如果你在这个方面一无所知，那就去找一本 C/C++ 
    的入门的书。<br>
    在本章的附录中列出 Lpc 常用的各个操作符的用法，以及MudOS提供的一些特别操作符。<br>
    2,3 小结<br>
    现在你应该知道在不同地方声明一个变量的区别了。我们在上面说的全局变量和一般的 
    C/C++ 中的全局变量的意义不同。一般的，在 C/C++的全局变量在这个程序执行整个过程一直存在，但是 
    Lpc 的全局变量实际是“类变量”，或者说是“Ojbect 变量”，一个 
    Object 的全局变量，在 Object 
    存在时存在，而没有真正的永远存在的“全局变量”。通过对操作符，变量、常量和函数的组合，你能得到一个很复杂的表达式，<br>
    比如：<br>
    i = ( x = sizeof( users() ) &gt; 0 ) ?<br>
    x -- : ( ( sizeof( children( NPC ) - 1 );<br>
    现在大家应该能知道上面的表达式的值了吧？其中 efun users() 
    返回所有的玩家，children( NPC ) 返回所有 NPC 复制的 Object, sizeof()能得知一个 
    array 或者 mapping 的大小。<br>
    第三节 流程控制<br>
    2.1 流程控制<br>
    在上一节的例子中：<br>
    -----<br>
    void SetX( int y )<br>
    {<br>
    int x;<br>
    x = y;<br>
    write( &quot;x is set to x&quot; + x + &quot; and will now be forgotten.\n&quot; );<br>
    }<br>
    -----<br>
    你可能只想在 y &gt; 1 时候把这个值赋予 x。怎么办，那就是流程控制的。流程控制，就是控制程序的执行过程。Lpc 
    和流程控制和 C/C++几乎可以说是完全一样。<br>
    2.2 流程控制语句<br>
    由于 Lpc 的流程控制实际上 C 
    的一样，我就不再介绍了。在本章的附录二中，列出了 Lpc 
    的流程控制语句。<br>
    强调一点，switch 可以完全由 if else if else 替代，比如：<br>
    switch ( id )<br>
    {<br>
    case &quot;trill&quot; :<br>
    write( &quot;你是飞鸟。\n&quot; );<br>
    break;<br>
    case &quot;falcon&quot; :<br>
    write( &quot;你是狐儿。\n&quot; );<br>
    break;<br>
    case &quot;qyz&quot; :<br>
    write( &quot;你是小马。\n&quot; );<br>
    break;<br>
    default :<br>
    write( &quot;你是谁？\n&quot; );<br>
    break;<br>
    }<br>
    可以写成这样：<br>
    if ( id == &quot;trill&quot; )<br>
    {<br>
    write( &quot;你是飞鸟。\n&quot; );<br>
    }<br>
    else if ( id == &quot;falcon&quot;)<br>
    {<br>
    write( &quot;你是狐儿。\n&quot; );<br>
    }<br>
    else if ( id == &quot;qyz&quot; )<br>
    {<br>
    write( &quot;你是小马。\n&quot; );<br>
    }<br>
    else<br>
    {<br>
    write(&quot;你是谁？\n&quot;);<br>
    }<br>
    但是 switch 语句更加贴近 CPU 的执行方式，也更自然。所以最好使<br>
    用 switch 语句，而不是 if else if else 的形式。<br>
    小结：<br>
    这一章介绍的实际是 C 的东西，所以如果你对于 C 语言不熟悉的话，<br>
    就找一本入门的书，看看变量，常量和流程控制的介绍。如果你对 C 
    有<br>
    写了解了，到现在，你应该能很容易的写一些简单的 room, npc 了。<br>
    附录一<br>
    Lpc 操作符<br>
    在这一附录，详细说明大部分的 Lpc 操作符。<br>
    Lpc 的操作符大概有下面这些：<br>
    = + - * / % += -= *= /= %=<br>
    -- ++ == != &gt; &lt; &gt;= &lt;= ! &amp;&amp; ||<br>
    -&gt; ? : &gt;&gt; &lt;&lt; &lt;&lt;= &gt;&gt;= &amp; | ^ &amp;=<br>
    |= ^= ...<br>
    这些操作符的说明有点枯燥无味，但是最好还是看看，因为有些操作符的行为有些怪异。<br>
    = 赋值操作符 ( assignment operator ):<br>
    例子: x = 5;<br>
    操作值 
    把等号右边表达式的值赋予左边的变量。等号左边只能是变量，就是说你不能赋予一个表达式值。<br>
    + 加号 ( addition operator ):<br>
    例子: x + 7<br>
    操作值：把加号左右的两个表达式的值(如果都是数值)加在一起，得到一个值。如果有一个表达式的值是 
    string 类型的，一个是 int 或者 float 类型，就直接把 int 和 float 
    的数值变成相应的字符串，接在 string 
    的对应的左边或右边。如果两个都是数组，那么就把两个数组和在一起得到一个新的数组。<br>
    - 减号 (subtraction operator ):<br>
    例子: x - 7<br>
    操作值：这个和 + 刚好现反。<br>
    * 乘号 ( multiplication operator ):<br>
    例子: x * 7<br>
    操作值：和数学上的乘法没有什么区别。<br>
    / 除法 ( division operator ):<br>
    例子: x / 7<br>
    操作值：和数学上的除法没有什么区别。<br>
    += additive assignment operator:<br>
    例子: x += 5<br>
    操作值：如果是 a += b，那就就是 a = a + b。<br>
    -= subtraction assignment operator<br>
    例子: x -= 7<br>
    操作值：如果是 a -= b，那就就是 a = a - b。<br>
    *= multiplicative assignment operator<br>
    例子: x *= 7<br>
    操作值：如果是 a *= b，那就就是 a = a * b。<br>
    /= division assignment operator<br>
    例子: x /= 7<br>
    操作值：如果是 a /= b，那就就是 a = a / b。<br>
    ++ post/pre-increment operators<br>
    例子: i ++ or ++ i<br>
    操作值：<br>
    i ++ 返回的值是 i，然后在把 i 加 1<br>
    ++ i 返回的值是 i + 1<br>
    -- post/pre-decrement operators<br>
    例子: i-- or --i<br>
    操作值：<br>
    i -- 返回的值是 i<br>
    -- i 返回的值是 i - 1<br>
    == equality operator<br>
    != inequality operator<br>
    &gt; greater than operator<br>
    &lt; less than operator<br>
    &gt; = greater than or equal to operator<br>
    &lt;= less than or equal to operator<br>
    例子: x == y x != y x &gt; y x &lt; y x &gt;= y x &lt;= y<br>
    &amp;&amp; logical and operator<br>
    || logical or operator<br>
    例子: x &amp;&amp; y x || y<br>
    ! negation operator<br>
    例子: !x<br>
    -&gt; the call other operator<br>
    例子: this_player()-&gt;GetKeyName()<br>
    操作值：调用一个 Object 的一个成员函数，左边必须是一个 Object右边是 
    Object 的一个函数，如果不存在，那么就返回 0。例子：task-&gt;event</small><br>
    操作值：返回一个 class 类型的变量的中的一个变量<br>
    ? : conditional operator<br>
    例子: x ? y : z<br>
    返回值：如果 x 是为真，那么就返回 y 的值，为假，就返回 z 
    的值这些操作符和 C 语言的完全一样。<br>
    下面的是高颁布的 MudOS 提供的：<br>
    &gt; &gt; &lt;&lt;<br>
    循环右移和左移<br>
    &amp; | ^<br>
    按位做 与 或 异或<br>
    &lt;&lt;= &gt;&gt;= &amp;= |= ^=<br>
    如果是 a X= b 那么就是 a = a X b<br>
    这些和 C 的也一样。<br>
    ...<br>
    返回一个数组的第一个元素。<br>
    附录二<br>
    流程控制语句：<br>
    if ( 表达式 )<br>
    {<br>
    指令集<br>
    }<br>
    if ( 表达式 )<br>
    {<br>
    指令集<br>
    }<br>
    else<br>
    {<br>
    指令集<br>
    }<br>
    if( 表达式 )<br>
    {<br>
    指令集<br>
    }<br>
    else if ( 表达式 )<br>
    {<br>
    指令集<br>
    }<br>
    else<br>
    {<br>
    指令集<br>
    }<br>
    while ( 表达式 )<br>
    {<br>
    指令集<br>
    }<br>
    switch ( 表达式 )<br>
    {<br>
    case ( 表达式 ):<br>
    指令集;<br>
    break;<br>
    default:<br>
    指令集<br>
    }<br>
    for( 表达式; 表达式; 表达式 )<br>
    这些和 C 的完全一样<br>
    return<br>
    结束这次函数的执行<br>
    continue<br>
    忽略这次循环<br>
    break<br>
    跳出循环体<br>
    高颁布的 MudOS 新提供的：<br>
    foreach()循环<br>
    foreach ( 变量类型 in 数组 )<br>
    比如：<br>
    void test()<br>
    {<br>
    foreach( object player in users() )<br>
    {<br>
    tell_object( player, &quot;hi..just a test.&quot; );<br>
    }<br>
    }<br>
    users() 这个 efun 返回一个 Object 的数组，所有在线的玩家。<br>
    foreach () 循环对数组中的每个元素，做一次循环。</small></td>
  </tr>
  <tr>
    <td width="83%"><p align="center"><a href="lpc_8.asp"><font size="2">上一篇</font></a></td>
  </tr>
</table>

   <TABLE border=0 cellPadding=0 cellSpacing=0 width=730>
  <TBODY>
  <TR>
    <TD bgColor=#000033 colSpan=3 height=2>
    </TD>
  </TR>
  </TBODY>
</TABLE>
<P>
<CENTER><FONT color=#919191 face=ARIAL,HELVETICA size=-1>对我们网站的建议和合作请与<A 
href="mailto:softroom@wuhee.edu.cn">mailto:softroom@wuhee.edu.cn</A>联系.<BR><BR>Copyright 
(C) 2000 网虫乐园工作室.<script src="http://202.114.98.14/count.js" width=468 height=60 border=0></script></FONT>
<P></P></CENTER></CENTER></CENTER></DIV></BODY></HTML>
