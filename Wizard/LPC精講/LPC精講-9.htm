
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>網蟲樂園--泥潭風雲</TITLE>
<META content="MSHTML 5.00.2919.6307" name=GENERATOR>
<META content=TLT name=Author>
<META content=text/html;charset=big5 http-equiv=content-type>
<style>
<!--      
A:link {text-decoration: none;color:blue}       
.105V         {font-size: 10.5pt; font-family: 宋體;}
TD          {font-size: 9pt; font-family: 宋體;}
.90V         {font-size: 9pt; font-family: 宋體;}
.90VE         {font-size: 9pt; font-family: arial;}
A:hover      {text-decoration: none;color:red;}
A:visited  {text-decoration: none;}
A:active     {text-decoration: none;color:#ff0000}
-->
</style>


<script>
<!--
lstart=50
loop=true
speed=350 
pr_step=5 

function makeObj(obj,nest){
nest=(!nest) ? '':'document.'+nest+'.'
this.css=(document.layers) ? eval(nest+'document.'+obj):eval(obj+'.style')
    this.scrollHeight=document.layers?this.css.document.height:eval(obj+'.offsetHeight')
    this.up=goUp
this.obj = obj + "Object"
eval(this.obj + "=this")
return this
}
function goUp(speed){
    if(parseInt(this.css.top)>-this.scrollHeight){
        this.css.top=parseInt(this.css.top)-pr_step
        setTimeout(this.obj+".up("+speed+")",speed)
    }else if(loop) {
        this.css.top=lstart
        eval(this.obj+".up("+speed+")")
    }
}
function slideInit(){
    oSlide=makeObj('divNews','divCont')
    oSlide.css.top=lstart
    oSlide.up(speed)
}
onload=slideInit
//-->
</script></head>

<body aLink="#660033" bgColor="#ffffff" leftMargin="0" text=darkgreen link="#000066" vLink="#000066"
topMargin="0" >
<div align="center"><center>
   <table border="1" width="776" borderColor=#ffffff borderColorLight=#ab9c36  align="center" bgColor=#f0f3dc cellPadding=0 cellSpacing=0 >
      <tr>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/home.gif width=15 height=15><a href=http://202.114.98.14/>網蟲樂園首頁</a></td> 
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/soft.gif height=15 width=15 border=0><a href="http://202.114.98.12/softroom/">軟件大觀園</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/mud.gif height=15 width=15 border=0><a href="http://202.114.98.14/mud/">泥潭風雲</font></a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/freeweb.gif height=15 width=15 border=0><a href="http://202.114.98.14/freeweb/">個人主頁空間</a></td>  
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/bbs.gif height=15 width=15 border=0><a href=http://202.114.98.14/bbs/>網蟲社區</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/webresource.gif height=15 width=15 border=0><a href="http://202.114.98.14/webresource/">Web資源角</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/show.gif height=15 width=15 border=0><a href="#" onclick="window.open('http://202.114.98.14/show/','','menubar=no,toolbar=no,location=no,directories=no,status=no,resizable=1,scrollbars=1,width=800,height=600,top=0,left=0');">秀網珍藏</a></td>
        <td align="center" width="97"><P align=center><img src=http://202.114.98.14/images/links1.gif height=15 width=15 border=0><a href=http://202.114.98.14/links/>友情鏈接</a></td>
      </tr>
    </table></center>

<table bgcolor=white width=770 border=1 borderColor=#ffffff borderColorLight=#ab9c36   cellpadding=0 cellspacing=0>
   <tr><td><table bgcolor=white width=770 border=0 cellpadding=0 cellspacing=0>
   <tr><td width=180 height=60><img src=http://202.114.98.14/images/netbugs1.gif width=180 height=60></td>
   <td align=center width=468 valign=center  bgcolor=white><script src="http://202.114.98.14/ad1.js" width=468 height=60 border=0></script></td>
   <td width=112 bgcolor=white><div id="divCont"
style="position:absolute; width:110; height:60; top:25; left:660; clip:rect(0,110,60,0)"><div
id="divNews" style="position:absolute; top:0; left:0">

<p>歡迎光臨網蟲樂園！<a href=http://202.114.98.14/>首頁</a>有網站各子站最新變動介紹和
教育網酷站連接。<p><a href=http://202.114.98.12/softroom/>軟件大觀園</a>每日更新；收藏3G軟件，均為最新版本。
<p><a href=http://202.114.98.14/mud>泥潭風雲</a>是教育網內最大的mud站點；<a href=http://202.114.98.14/webresource>Web資源角</a>有三千多動畫和背景為你網頁增添色彩。
<p><a href=http://202.114.98.14/freeweb/>10M免費個人主頁空間</a>，ftp維護；申請三日內批准。<p><a href=http://202.114.98.14/show>秀網珍藏</a>圖片近2G，欄目眾多，包羅萬像，每日都有大量圖片增加。
<p>對我們網站的建設的建議歡迎<a href=mailto:softroom@wuhee.edu.cn>來信</a>或寫在<a href=http://202.114.98.14/bbs>社區</a>內。</p>
</div></div>
</td>
   </tr>
   </table>
</td></tr></table>

<center>
   <table border="1" width="770" borderColor=#ffffff borderColorLight=#ab9c36  align="center" bgColor=#f0f3dc cellPadding=0 cellSpacing=0 >
      <tr>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/index.htm">首頁</A></td> 
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/newcomer/">泥巴入門</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/player/">泥巴進階</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/source/">泥巴資源</A></td>  
        <td align="center" width="96"><P align=center><A 
        href="http://202.114.98.14/mud/pmud/">圖形泥巴</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/mudlife/">泥巴人生</A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/wiz/">巫師樂園</FONT></A></td>
        <td align="center" width="96"><P align=center><A href="http://202.114.98.14/mud/download/">軟件下載</A>            <SCRIPT>
   document.write("<a href=http://webpub.au.tsinghua.edu.cn/count/count.dll?Type=Basic&id=2138&ReferID=2138 target=_blank>");
   document.write("<img src=http://webpub.au.tsinghua.edu.cn/count/count.dll?Type=Img2&add=1&id=2138&refer="+escape(top.document.referrer)+" border=0 alt=酷站今日訪問 width=12 height=12>");
   </SCRIPT></td>

      </tr>
    </table></center>
    


<table border="0" width="100%" style="color: rgb(255,255,0)" cellspacing="0" cellpadding="0">
  <tr>
    <td width="8%" rowspan="4"></td>
    <td width="83%"><p align="center"><font color="#000000">LPC語言<br>
    –––––––––––––––––––––<br>
    <font size="2">綜合地介紹MUD編程語言（LPC）<br>
    –––––––––––––––––––––––––</font></font></td>
    <td width="9%" rowspan="4"></td>
  </tr>
  <tr>
    <td width="83%"><p align="center"><font color="#000000">LPC語言精講（9）</td>
  </tr>
  <tr>
    <td width="83%"><font color="#000000">第五章 變量控制和流程控制<br>
    第一節 序言<br>
    到今天，你應該能自己編寫一些簡單的 Object 了，通過使用你所在的 
    Mud 的標準的 Object 庫。 
    你應該知道什麼是繼承了，還有你應該能自己寫一些函數來表現你自己的 
    Object 特有的性質了。在這一章，你將知道 Lpc 
    的最基本的一些元素，比如：表達式、操作符等，在你自己寫的函數通過一些基本元素的組合來操縱變量，通過流程控制來使的你的函數更為複雜，而不是線性執行到最後。<br>
    第二節 變量<br>
    2.1 值和變量<br>
    從根本來說，任意兩個 Object 不同的地方有兩個方面：<br>
    1) 一些函數不同<br>
    2) 各個變量的值不同<br>
    舉個例子，所有的玩家 Object 
    有完全一樣的函數。因此他們不同的只是保持的值不同。比如，玩家名字叫做 
    &quot;falcon&quot; 和 &quot;trill&quot; 不同，其最根本的不同的是因為變量 
    &quot;dbase/id&quot; 這個值不同，一個是&quot;falcon&quot;另一個是 
    &quot;trill&quot; 。因此，在 Mud 中的變化就是各個 Object 
    中的值的變化。函數是用來命名那些可以改變操縱變量的特殊的一些過程。舉個例子，函數create()就是這樣一個過程：初始化一個 
    Object 
    的各個變量的值的一個過程。在函數里面，有個特別的東西叫做 
    指令 用於直接改變操縱變量。<br>
    2.2 局部和全局變量<br>
    和大多數的編程語言一樣，Lpc 
    的變量可以被聲明成一個函數的局部變量，也可以是全局變量(這個全局變量只在一個Object 
    內部是全局的，對於其他 Object 的函數是不能訪問的)。局部變量在一個函數定義內部聲明，只在這個函數內部使用。別的函數無法得知它的存在。全部變量則只要所在的 
    Object 存在時間內，可以被這個 Obejct 
    聲明的任何函數調用，就是它一直在內存中存在。看看下面的兩個例子：<br>
    -----<br>
    int x;<br>
    int GetX()<br>
    {<br>
    return x;<br>
    }<br>
    void SetX( int y )<br>
    {<br>
    x = y;<br>
    }<br>
    -----<br>
    -----<br>
    void SetX( int y )<br>
    {<br>
    int x;<br>
    x = y;<br>
    write( &quot;x is set to x&quot; + x + &quot; and will now be forgotten.\n&quot; );<br>
    }<br>
    -----<br>
    在第一個例子裡面，x 
    在所有的函數的外部聲明，所以它可以被它後面的任何函數使用。在這個例子中，x 
    就是一個全局變量。<br>
    在第二個例子中，x 在函數 SetX() 的內部聲明。它只有在函數 SetX()被執行時才存在。然後，它就消失了。在這個例子中，x 
    是局部變量。<br>
    2.2 表達式和操作符<br>
    在 Lpc 中表達式和操作符的意義和 C/C++ 
    的完全一樣，如果你在這個方面一無所知，那就去找一本 C/C++ 
    的入門的書。<br>
    在本章的附錄中列出 Lpc 常用的各個操作符的用法，以及MudOS提供的一些特別操作符。<br>
    2,3 小結<br>
    現在你應該知道在不同地方聲明一個變量的區別了。我們在上面說的全局變量和一般的 
    C/C++ 中的全局變量的意義不同。一般的，在 C/C++的全局變量在這個程序執行整個過程一直存在，但是 
    Lpc 的全局變量實際是“類變量”，或者說是“Ojbect 變量”，一個 
    Object 的全局變量，在 Object 
    存在時存在，而沒有真正的永遠存在的“全局變量”。通過對操作符，變量、常量和函數的組合，你能得到一個很複雜的表達式，<br>
    比如：<br>
    i = ( x = sizeof( users() ) &gt; 0 ) ?<br>
    x -- : ( ( sizeof( children( NPC ) - 1 );<br>
    現在大家應該能知道上面的表達式的值了吧？其中 efun users() 
    返回所有的玩家，children( NPC ) 返回所有 NPC 復制的 Object, sizeof()能得知一個 
    array 或者 mapping 的大小。<br>
    第三節 流程控制<br>
    2.1 流程控制<br>
    在上一節的例子中：<br>
    -----<br>
    void SetX( int y )<br>
    {<br>
    int x;<br>
    x = y;<br>
    write( &quot;x is set to x&quot; + x + &quot; and will now be forgotten.\n&quot; );<br>
    }<br>
    -----<br>
    你可能只想在 y &gt; 1 時候把這個值賦予 x。怎麼辦，那就是流程控制的。流程控制，就是控制程序的執行過程。Lpc 
    和流程控制和 C/C++幾乎可以說是完全一樣。<br>
    2.2 流程控制語句<br>
    由於 Lpc 的流程控制實際上 C 
    的一樣，我就不再介紹了。在本章的附錄二中，列出了 Lpc 
    的流程控制語句。<br>
    強調一點，switch 可以完全由 if else if else 替代，比如：<br>
    switch ( id )<br>
    {<br>
    case &quot;trill&quot; :<br>
    write( &quot;你是飛鳥。\n&quot; );<br>
    break;<br>
    case &quot;falcon&quot; :<br>
    write( &quot;你是狐兒。\n&quot; );<br>
    break;<br>
    case &quot;qyz&quot; :<br>
    write( &quot;你是小馬。\n&quot; );<br>
    break;<br>
    default :<br>
    write( &quot;你是誰？\n&quot; );<br>
    break;<br>
    }<br>
    可以寫成這樣：<br>
    if ( id == &quot;trill&quot; )<br>
    {<br>
    write( &quot;你是飛鳥。\n&quot; );<br>
    }<br>
    else if ( id == &quot;falcon&quot;)<br>
    {<br>
    write( &quot;你是狐兒。\n&quot; );<br>
    }<br>
    else if ( id == &quot;qyz&quot; )<br>
    {<br>
    write( &quot;你是小馬。\n&quot; );<br>
    }<br>
    else<br>
    {<br>
    write(&quot;你是誰？\n&quot;);<br>
    }<br>
    但是 switch 語句更加貼近 CPU 的執行方式，也更自然。所以最好使<br>
    用 switch 語句，而不是 if else if else 的形式。<br>
    小結：<br>
    這一章介紹的實際是 C 的東西，所以如果你對於 C 語言不熟悉的話，<br>
    就找一本入門的書，看看變量，常量和流程控制的介紹。如果你對 C 
    有<br>
    寫了解了，到現在，你應該能很容易的寫一些簡單的 room, npc 了。<br>
    附錄一<br>
    Lpc 操作符<br>
    在這一附錄，詳細說明大部分的 Lpc 操作符。<br>
    Lpc 的操作符大概有下面這些：<br>
    = + - * / % += -= *= /= %=<br>
    -- ++ == != &gt; &lt; &gt;= &lt;= ! &amp;&amp; ||<br>
    -&gt; ? : &gt;&gt; &lt;&lt; &lt;&lt;= &gt;&gt;= &amp; | ^ &amp;=<br>
    |= ^= ...<br>
    這些操作符的說明有點枯燥無味，但是最好還是看看，因為有些操作符的行為有些怪異。<br>
    = 賦值操作符 ( assignment operator ):<br>
    例子: x = 5;<br>
    操作值 
    把等號右邊表達式的值賦予左邊的變量。等號左邊只能是變量，就是說你不能賦予一個表達式值。<br>
    + 加號 ( addition operator ):<br>
    例子: x + 7<br>
    操作值：把加號左右的兩個表達式的值(如果都是數值)加在一起，得到一個值。如果有一個表達式的值是 
    string 類型的，一個是 int 或者 float 類型，就直接把 int 和 float 
    的數值變成相應的字符串，接在 string 
    的對應的左邊或右邊。如果兩個都是數組，那麼就把兩個數組和在一起得到一個新的數組。<br>
    - 減號 (subtraction operator ):<br>
    例子: x - 7<br>
    操作值：這個和 + 剛好現反。<br>
    * 乘號 ( multiplication operator ):<br>
    例子: x * 7<br>
    操作值：和數學上的乘法沒有什麼區別。<br>
    / 除法 ( division operator ):<br>
    例子: x / 7<br>
    操作值：和數學上的除法沒有什麼區別。<br>
    += additive assignment operator:<br>
    例子: x += 5<br>
    操作值：如果是 a += b，那就就是 a = a + b。<br>
    -= subtraction assignment operator<br>
    例子: x -= 7<br>
    操作值：如果是 a -= b，那就就是 a = a - b。<br>
    *= multiplicative assignment operator<br>
    例子: x *= 7<br>
    操作值：如果是 a *= b，那就就是 a = a * b。<br>
    /= division assignment operator<br>
    例子: x /= 7<br>
    操作值：如果是 a /= b，那就就是 a = a / b。<br>
    ++ post/pre-increment operators<br>
    例子: i ++ or ++ i<br>
    操作值：<br>
    i ++ 返回的值是 i，然後在把 i 加 1<br>
    ++ i 返回的值是 i + 1<br>
    -- post/pre-decrement operators<br>
    例子: i-- or --i<br>
    操作值：<br>
    i -- 返回的值是 i<br>
    -- i 返回的值是 i - 1<br>
    == equality operator<br>
    != inequality operator<br>
    &gt; greater than operator<br>
    &lt; less than operator<br>
    &gt; = greater than or equal to operator<br>
    &lt;= less than or equal to operator<br>
    例子: x == y x != y x &gt; y x &lt; y x &gt;= y x &lt;= y<br>
    &amp;&amp; logical and operator<br>
    || logical or operator<br>
    例子: x &amp;&amp; y x || y<br>
    ! negation operator<br>
    例子: !x<br>
    -&gt; the call other operator<br>
    例子: this_player()-&gt;GetKeyName()<br>
    操作值：調用一個 Object 的一個成員函數，左邊必須是一個 Object右邊是 
    Object 的一個函數，如果不存在，那麼就返回 0。例子：task-&gt;event</small><br>
    操作值：返回一個 class 類型的變量的中的一個變量<br>
    ? : conditional operator<br>
    例子: x ? y : z<br>
    返回值：如果 x 是為真，那麼就返回 y 的值，為假，就返回 z 
    的值這些操作符和 C 語言的完全一樣。<br>
    下面的是高頒布的 MudOS 提供的：<br>
    &gt; &gt; &lt;&lt;<br>
    循環右移和左移<br>
    &amp; | ^<br>
    按位做 與 或 異或<br>
    &lt;&lt;= &gt;&gt;= &amp;= |= ^=<br>
    如果是 a X= b 那麼就是 a = a X b<br>
    這些和 C 的也一樣。<br>
    ...<br>
    返回一個數組的第一個元素。<br>
    附錄二<br>
    流程控制語句：<br>
    if ( 表達式 )<br>
    {<br>
    指令集<br>
    }<br>
    if ( 表達式 )<br>
    {<br>
    指令集<br>
    }<br>
    else<br>
    {<br>
    指令集<br>
    }<br>
    if( 表達式 )<br>
    {<br>
    指令集<br>
    }<br>
    else if ( 表達式 )<br>
    {<br>
    指令集<br>
    }<br>
    else<br>
    {<br>
    指令集<br>
    }<br>
    while ( 表達式 )<br>
    {<br>
    指令集<br>
    }<br>
    switch ( 表達式 )<br>
    {<br>
    case ( 表達式 ):<br>
    指令集;<br>
    break;<br>
    default:<br>
    指令集<br>
    }<br>
    for( 表達式; 表達式; 表達式 )<br>
    這些和 C 的完全一樣<br>
    return<br>
    結束這次函數的執行<br>
    continue<br>
    忽略這次循環<br>
    break<br>
    跳出循環體<br>
    高頒布的 MudOS 新提供的：<br>
    foreach()循環<br>
    foreach ( 變量類型 in 數組 )<br>
    比如：<br>
    void test()<br>
    {<br>
    foreach( object player in users() )<br>
    {<br>
    tell_object( player, &quot;hi..just a test.&quot; );<br>
    }<br>
    }<br>
    users() 這個 efun 返回一個 Object 的數組，所有在線的玩家。<br>
    foreach () 循環對數組中的每個元素，做一次循環。</small></td>
  </tr>
  <tr>
    <td width="83%"><p align="center"><a href="lpc_8.asp"><font size="2">上一篇</font></a></td>
  </tr>
</table>

   <TABLE border=0 cellPadding=0 cellSpacing=0 width=730>
  <TBODY>
  <TR>
    <TD bgColor=#000033 colSpan=3 height=2>
    </TD>
  </TR>
  </TBODY>
</TABLE>
<P>
<CENTER><FONT color=#919191 face=ARIAL,HELVETICA size=-1>對我們網站的建議和合作請與<A 
href="mailto:softroom@wuhee.edu.cn">mailto:softroom@wuhee.edu.cn</A>聯繫.<BR><BR>Copyright 
(C) 2000 網蟲樂園工作室.<script src="http://202.114.98.14/count.js" width=468 height=60 border=0></script></FONT>
<P></P></CENTER></CENTER></CENTER></DIV></BODY></HTML>
